{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/es6-promise/dist/es6-promise.js","node_modules/events/events.js","node_modules/process/browser.js","src/audio/pcmplayer.js","src/core/media-info.js","src/demux/amf-parser.js","src/demux/demux-errors.js","src/demux/exp-golomb.js","src/demux/flv-demuxer.js","src/demux/sps-parser.js","src/flv2canvas.js","src/flv2canvas.loader.js","src/index.js","src/loader/fetch-stream-loader.js","src/loader/io-controller.js","src/loader/loader.js","src/loader/speed-sampler.js","src/render/yuv-canvas.js","src/utils/browser.js","src/utils/exception.js","src/utils/logger.js","src/utils/polyfill.js","src/utils/utf8-conv.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","flv2canvas","r","e","n","t","o","i","c","require","u","a","Error","code","p","call","length","1","_dereq_","factory","ES6Promise","objectOrFunction","x","type","isFunction","setScheduler","scheduleFn","customSchedulerFn","setAsap","asapFn","asap","useVertxTimer","vertxNext","flush","useSetTimeout","globalSetTimeout","setTimeout","len","callback","queue","undefined","then","onFulfillment","onRejection","parent","child","constructor","noop","PROMISE_ID","makePromise","_state","arguments","invokeCallback","_result","subscribe","resolve$1","object","Constructor","promise","resolve","selfFulfillment","TypeError","cannotReturnOwn","tryThen","then$$1","value","fulfillmentHandler","rejectionHandler","handleForeignThenable","thenable","sealed","error","fulfill","reason","reject","_label","handleOwnThenable","FULFILLED","REJECTED","handleMaybeThenable","maybeThenable","publishRejection","_onerror","publish","PENDING","_subscribers","subscribers","settled","detail","hasCallback","succeeded","initializePromise","resolver","nextId","id","validationError","all","entries","Enumerator","race","isArray","_","reject$1","needsResolver","needsNew","polyfill","local","Function","P","Promise","promiseToString","Object","prototype","toString","cast","Promise$1","_isArray","Array","arg","scheduleFlush","browserWindow","browserGlobal","BrowserMutationObserver","MutationObserver","WebKitMutationObserver","isNode","process","isWorker","Uint8ClampedArray","importScripts","MessageChannel","nextTick","iterations","observer","node","document","createTextNode","observe","characterData","data","channel","port1","onmessage","port2","postMessage","vertx","runOnLoop","runOnContext","Math","random","substring","input","_instanceConstructor","_remaining","_enumerate","_eachEntry","entry","resolve$$1","_then","didError","_settledAt","_willSettleAt","state","enumerator","catch","finally","_setScheduler","_setAsap","_asap","EventEmitter","_events","hasOwnProperty","objectCreate","_eventsCount","_maxListeners","$getMaxListeners","that","defaultMaxListeners","emitNone","handler","isFn","listeners","arrayClone","emitOne","arg1","emitTwo","arg2","emitThree","arg3","emitMany","args","apply","_addListener","target","listener","prepend","m","events","existing","newListener","emit","unshift","push","warned","w","String","name","emitter","count","console","warn","message","onceWrapper","fired","removeListener","wrapFn","_onceWrap","wrapped","bind","_listeners","unwrap","evlistener","unwrapListeners","listenerCount","spliceOne","list","index","k","pop","arr","copy","ret","objectCreatePolyfill","proto","F","objectKeysPolyfill","obj","keys","functionBindPolyfill","context","fn","create","objectKeys","hasDefineProperty","defineProperty","err","enumerable","get","set","setMaxListeners","isNaN","getMaxListeners","er","doError","addListener","on","prependListener","once","prependOnceListener","position","originalListener","shift","removeAllListeners","key","rawListeners","eventNames","Reflect","ownKeys","defaultSetTimout","defaultClearTimeout","runTimeout","fun","cachedSetTimeout","runClearTimeout","marker","cachedClearTimeout","clearTimeout","cleanUpNextTick","draining","currentQueue","concat","queueIndex","drainQueue","timeout","run","Item","array","title","browser","env","argv","version","versions","off","binding","cwd","chdir","dir","umask","PCMPlayer","option","defaults","encoding","flushingTime","assign","samples","Float32Array","sampleRate","interval","setInterval","maxValue","getMaxValue","typedArray","getTypedArray","createContext","encodings","8bitInt","16bitInt","32bitInt","32bitFloat","typedArrays","Int8Array","Int16Array","Int32Array","audioCtx","AudioContext","webkitAudioContext","gainNode","createGain","gain","connect","destination","startTime","currentTime","isTypedArray","byteLength","buffer","ArrayBuffer","feed","tmp","clean","getFormatedValue","final","float32","volume","destroy","clearInterval","close","bufferSource","createBufferSource","channels","audioBuffer","createBuffer","audioData","offset","decrement","getChannelData","start","duration","MediaInfo","_classCallCheck","mimeType","hasAudio","hasVideo","audioCodec","videoCodec","audioDataRate","videoDataRate","audioSampleRate","audioChannelCount","width","height","fps","profile","level","refFrames","chromaFormat","sarNum","sarDen","metadata","segments","segmentCount","hasKeyframesIndex","keyframesIndex","audioInfoComplete","videoInfoComplete","milliseconds","table","keyframeIdx","_search","times","fileposition","filepositions","idx","last","mid","lbound","ubound","floor","_logger","_utf8Conv","_exception","le","buf","DataView","setInt16","AMF","arrayBuffer","dataOffset","dataSize","parseValue","size","_logger2","default","IllegalStateException","parseString","isObjectEnd","objectEnd","parseObject","v","getUint16","str","_utf8Conv2","Uint8Array","getUint32","timestamp","getFloat64","getInt16","Date","getUint8","amfstr","terminal","amfobj","_terminal","amfvar","parseVariable","strictArrayLength","val","date","parseDate","amfLongStr","DemuxErrors","OK","FORMAT_ERROR","FORMAT_UNSUPPORTED","CODEC_UNSUPPORTED","ExpGolomb","uint8array","TAG","_buffer","_buffer_index","_total_bytes","_total_bits","_current_word","_current_word_bits_left","buffer_bytes_left","bytes_read","min","word","subarray","bits","InvalidArgumentException","result","bits_need_left","_fillCurrentWord","bits_read_next","result2","readBits","zero_count","_skipLeadingZero","leading_zeros","readUEG","_toConsumableArray","arr2","from","ReadBig32","_amfParser","_spsParser","_demuxErrors","_mediaInfo","FLVDemuxer","probeData","config","_config","_onError","_onMediaInfo","_onMetaDataArrived","_onScriptDataArrived","_onTrackMetadata","_onDataAvailable","_dataOffset","_firstParse","_dispatch","_hasAudio","hasAudioTrack","_hasVideo","hasVideoTrack","_hasAudioFlagOverrided","_hasVideoFlagOverrided","_audioInitialMetadataDispatched","_videoInitialMetadataDispatched","_mediaInfo2","_metadata","_audioMetadata","_videoMetadata","_naluLengthSize","_timestampBase","_timescale","_duration","_durationOverrided","_referenceFrameRate","fixed","fps_num","fps_den","_flvSoundRateTable","_mpegSamplingRates","_mpegAudioV10SampleRateTable","_mpegAudioV20SampleRateTable","_mpegAudioV25SampleRateTable","_mpegAudioL1BitRateTable","_mpegAudioL2BitRateTable","_mpegAudioL3BitRateTable","_videoTrack","sequenceNumber","_audioTrack","_littleEndian","onAudioParseDone","onVideoParseDone","loader","chunk","byteStart","probe","_v","tagType","ts2","ts1","ts0","ts3","_parseAudioData","_parseVideoData","_parseScriptData","prevTagSize","scriptData","_amfParser2","parseScriptData","onMetaData","_typeof","audiodatarate","videodatarate","framerate","keyframes","_parseKeyframesIndex","isComplete","time","tagTimestamp","soundSpec","soundFormat","_demuxErrors2","soundRate","soundRateIndex","soundType","meta","track","timescale","channelCount","aacData","_parseAACAudioData","packetType","misc","samplingRate","codec","originalCodec","configRaw","audioObjectType","samplingFrequencyIndex","samplingIndex","channelConfig","refSampleDuration","_isInitialMetadataDispatched","HEADER","mi","dts","aacSample","unit","pts","_this","headers","init","adtsLen","_misc","_parseMP3AudioData","_mi","bitRate","_dts","mp3Sample","_parseAACAudioSpecificConfig","originalAudioObjectType","extensionSamplingIndex","samplingFrequence","userAgent","navigator","toLowerCase","indexOf","requestHeader","ver","layer","bitrate_index","sampling_freq_index","channel_mode","channel_count","sample_rate","bit_rate","tagPosition","spec","frameType","codecId","_parseAVCVideoPacket","cts_unsigned","cts","_parseAVCDecoderConfigurationRecord","_parseAVCVideoData","avcc","avcProfile","spsCount","sps","finalsps","_spsParser2","parseSPS","codecWidth","codec_size","codecHeight","presentWidth","present_size","presentHeight","profile_string","level_string","bitDepth","bit_depth","chroma_format","sarRatio","sar_ratio","frameRate","frame_rate","codecArray","codecString","j","h","ref_frames","chroma_format_string","ppsCount","_i","_len","pps","finalpps","units","lengthSize","keyframe","naluSize","unitType","finalData","avcSample","isKeyframe","saveDts","base","mismatch","match","consumed","_expGolomb","SPSParser","src","src_length","dst","dst_idx","rbsp","_ebsp2rbsp","gb","_expGolomb2","readByte","profile_idc","level_idc","getProfileString","getLevelString","chroma_format_idc","chroma_format_table","readBool","scaling_list_count","_skipScalingList","pic_order_cnt_type","readSEG","num_ref_frames_in_pic_order_cnt_cycle","pic_width_in_mbs_minus1","pic_height_in_map_units_minus1","frame_mbs_only_flag","frame_crop_left_offset","frame_crop_right_offset","frame_crop_top_offset","frame_crop_bottom_offset","sar_width","sar_height","fps_fixed","aspect_ratio_idc","sar_w_table","sar_h_table","num_units_in_tick","time_scale","sarScale","crop_unit_x","crop_unit_y","sub_wc","sub_hc","codec_width","codec_height","present_width","ceil","getChromaFormatString","last_scale","next_scale","delta_scale","toFixed","chroma","_flv2canvas","_yuvCanvas","_pcmplayer","options","playWidth","playHeight","videoBuffer","videoDts","audioDts","audioDtsCur","startPlay","canvasObj","initRender","initAudio","load","url","loadCtl","_flv2canvas2","_saveDts","createLoader","initWorker","log","avc","audioCtrl","worker","terminate","cancelAnimationFrame","_pcmplayer2","Worker","workFile","rgb","memsize","reuseMemory","addEventListener","consoleLog","typeArr","doSaveAudioDts","typeArr2","onPictureDecoded","infos","doRender","requestAnimationFrame","noData","restart","isLoading","showLoading","hasFixPosition","now","diffTime","renderFrame","fixPosition","renderFrameWebGL","createCanvasObj","createCanvasWebGL","canvas","canvasDom","hidden","isPush","arr1","slice","webGLCanvas","_yuvCanvas2","contextOptions","ylen","uvlen","drawNextOutputPicture","yData","uData","vData","recycleMemory","parArray","reuse","_createBasicCanvasObj","createElement","style","backgroundColor","_polyfill","_ioController","_polyfill2","install","Flv2CanvasLoader","optionalConfig","ioctl","_ioController2","_onVideoParseDone","_onAudioParseDone","_browser","_loader","FetchStreamLoader","_possibleConstructorReturn","__proto__","getPrototypeOf","_needStash","_requestAbort","_contentLength","_receivedLength","isWorkWellEdge","_browser2","msedge","minor","browserNotBlacklisted","fetch","ReadableStream","isWorking","abort","_get","_this2","Headers","params","method","mode","cache","referrerPolicy","append","_status","LoaderStatus","kConnecting","res","ok","status","lengthHeader","parseInt","_onContentLengthKnown","_pump","body","getReader","kError","LoaderErrors","HTTP_STATUS_CODE_INVALID","msg","statusText","EXCEPTION","reader","_this3","read","done","kComplete","cancel","kBuffering","_range","_onDataArrival","_chunk","_byteStart","info","EARLY_EOF","BaseLoader","_fetchStreamLoader","_flvDemuxer","_speedSampler","IOController","_loaderClass","_seekHandler","_emitter","_events2","_stashUsed","_stashSize","_stashInitialSize","_bufferSize","_stashBuffer","_stashByteStart","_enableStash","enableStashBuffer","_totalLength","_refTotalLength","_fullRequestFlag","_currentRange","_redirectedURL","_speedNormalized","_speedSampler2","_speedNormalizeList","_selectLoader","_createLoader","_fetchStreamLoader2","isSupported","needStashBuffer","onDataArrival","_onLoaderChunkArrival","open","_demuxer","bindDataSource","parseChunks","_flvDemuxer2","onScriptDataArrived","receivedLength","_paused","_isEarlyEofReconnecting","_onRecoveredEarlyEof","addBytes","KBps","lastSecondKBps","normalized","_normalizeSpeed","_adjustStashSize","_stashArray2","_stashArray3","_consumed2","_dispatchChunks","_remainArray","_expandBuffer","_consumed3","_remain","remain","stashArray","_stashArray","_consumed","remainArray","stashSizeKB","isLive","bufferSize","expectedBytes","bufferNewSize","newBuffer","stashOldArray","chunks","_onInitChunkArrival","kIdle","CONNECTING_TIMEOUT","UNRECOVERABLE_EARLY_EOF","typeName","_type","_onURLRedirect","_onComplete","dataSource","range","SpeedSampler","_firstCheckpoint","_lastCheckpoint","_intervalBytes","_totalBytes","_lastSecondBytes","performance","_now","bytes","durationSeconds","currentKBps","YUVCanvas","parOptions","canvasElement","customYUV444","conversionType","animationTime","initContextGL","contextGL","initProgram","initBuffers","initTextures","drawNextOuptutPictureGL","par","gl","texturePosBuffer","uTexturePosBuffer","vTexturePosBuffer","yTextureRef","uTextureRef","vTextureRef","yDataPerRow","yRowCnt","uDataPerRow","uRowCnt","vDataPerRow","vRowCnt","viewport","tBottom","tRight","texturePosValues","bindBuffer","ARRAY_BUFFER","bufferData","DYNAMIC_DRAW","uTexturePosValues","vTexturePosValues","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","texImage2D","LUMINANCE","UNSIGNED_BYTE","TEXTURE1","TEXTURE2","drawArrays","TRIANGLE_STRIP","textureRef","dataPerRow","rowCnt","uniform2f","getUniformLocation","shaderProgram","validContextNames","nameIndex","contextName","getContext","getParameter","vertexShaderScript","fragmentShaderScript","join","YUV2RGB","vertexShader","createShader","VERTEX_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","fragmentShader","FRAGMENT_SHADER","program","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","useProgram","YUV2RGBRef","uniformMatrix4fv","vertexPosBuffer","STATIC_DRAW","vertexPosRef","getAttribLocation","enableVertexAttribArray","vertexAttribPointer","FLOAT","timePassed","aniFun","mul","neg","pos","texturePosRef","uTexturePosRef","vTexturePosRef","initTexture","ySamplerRef","uniform1i","uSamplerRef","vSamplerRef","samplerRef","createTexture","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","croppingParams","drawNextOuptutPictureRGBA","argbData","ctx","imageData","getImageData","putImageData","left","top","Browser","ua","exec","platform_match","matched","majorVersion","platform","versionArray","split","major","string","build","chrome","opr","safari","webkit","rv","iemobile","edge","android","RuntimeException","_message","NotImplementedException","Log","tag","FORCE_GLOBAL_TAG","GLOBAL_TAG","ENABLE_CALLBACK","ENABLE_ERROR","ENABLE_INFO","ENABLE_WARN","ENABLE_DEBUG","debug","ENABLE_VERBOSE","Polyfill","setPrototypeOf","output","source","checkContinuation","checkLength","decodeUTF8","out","fromCharCode","ucs4","_ucs","_ucs2"],"mappings":"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","file":"flv2canvas.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","/*!\n * @overview es6-promise - a tiny implementation of Promises/A+.\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\n * @license   Licensed under MIT license\n *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE\n * @version   v4.2.8+1e68dce6\n */\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.ES6Promise = factory());\n}(this, (function () { 'use strict';\n\nfunction objectOrFunction(x) {\n  var type = typeof x;\n  return x !== null && (type === 'object' || type === 'function');\n}\n\nfunction isFunction(x) {\n  return typeof x === 'function';\n}\n\n\n\nvar _isArray = void 0;\nif (Array.isArray) {\n  _isArray = Array.isArray;\n} else {\n  _isArray = function (x) {\n    return Object.prototype.toString.call(x) === '[object Array]';\n  };\n}\n\nvar isArray = _isArray;\n\nvar len = 0;\nvar vertxNext = void 0;\nvar customSchedulerFn = void 0;\n\nvar asap = function asap(callback, arg) {\n  queue[len] = callback;\n  queue[len + 1] = arg;\n  len += 2;\n  if (len === 2) {\n    // If len is 2, that means that we need to schedule an async flush.\n    // If additional callbacks are queued before the queue is flushed, they\n    // will be processed by this flush that we are scheduling.\n    if (customSchedulerFn) {\n      customSchedulerFn(flush);\n    } else {\n      scheduleFlush();\n    }\n  }\n};\n\nfunction setScheduler(scheduleFn) {\n  customSchedulerFn = scheduleFn;\n}\n\nfunction setAsap(asapFn) {\n  asap = asapFn;\n}\n\nvar browserWindow = typeof window !== 'undefined' ? window : undefined;\nvar browserGlobal = browserWindow || {};\nvar BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\nvar isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';\n\n// test for web worker but not in IE10\nvar isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined';\n\n// node\nfunction useNextTick() {\n  // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n  // see https://github.com/cujojs/when/issues/410 for details\n  return function () {\n    return process.nextTick(flush);\n  };\n}\n\n// vertx\nfunction useVertxTimer() {\n  if (typeof vertxNext !== 'undefined') {\n    return function () {\n      vertxNext(flush);\n    };\n  }\n\n  return useSetTimeout();\n}\n\nfunction useMutationObserver() {\n  var iterations = 0;\n  var observer = new BrowserMutationObserver(flush);\n  var node = document.createTextNode('');\n  observer.observe(node, { characterData: true });\n\n  return function () {\n    node.data = iterations = ++iterations % 2;\n  };\n}\n\n// web worker\nfunction useMessageChannel() {\n  var channel = new MessageChannel();\n  channel.port1.onmessage = flush;\n  return function () {\n    return channel.port2.postMessage(0);\n  };\n}\n\nfunction useSetTimeout() {\n  // Store setTimeout reference so es6-promise will be unaffected by\n  // other code modifying setTimeout (like sinon.useFakeTimers())\n  var globalSetTimeout = setTimeout;\n  return function () {\n    return globalSetTimeout(flush, 1);\n  };\n}\n\nvar queue = new Array(1000);\nfunction flush() {\n  for (var i = 0; i < len; i += 2) {\n    var callback = queue[i];\n    var arg = queue[i + 1];\n\n    callback(arg);\n\n    queue[i] = undefined;\n    queue[i + 1] = undefined;\n  }\n\n  len = 0;\n}\n\nfunction attemptVertx() {\n  try {\n    var vertx = Function('return this')().require('vertx');\n    vertxNext = vertx.runOnLoop || vertx.runOnContext;\n    return useVertxTimer();\n  } catch (e) {\n    return useSetTimeout();\n  }\n}\n\nvar scheduleFlush = void 0;\n// Decide what async method to use to triggering processing of queued callbacks:\nif (isNode) {\n  scheduleFlush = useNextTick();\n} else if (BrowserMutationObserver) {\n  scheduleFlush = useMutationObserver();\n} else if (isWorker) {\n  scheduleFlush = useMessageChannel();\n} else if (browserWindow === undefined && typeof require === 'function') {\n  scheduleFlush = attemptVertx();\n} else {\n  scheduleFlush = useSetTimeout();\n}\n\nfunction then(onFulfillment, onRejection) {\n  var parent = this;\n\n  var child = new this.constructor(noop);\n\n  if (child[PROMISE_ID] === undefined) {\n    makePromise(child);\n  }\n\n  var _state = parent._state;\n\n\n  if (_state) {\n    var callback = arguments[_state - 1];\n    asap(function () {\n      return invokeCallback(_state, child, callback, parent._result);\n    });\n  } else {\n    subscribe(parent, child, onFulfillment, onRejection);\n  }\n\n  return child;\n}\n\n/**\n  `Promise.resolve` returns a promise that will become resolved with the\n  passed `value`. It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    resolve(1);\n  });\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.resolve(1);\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  @method resolve\n  @static\n  @param {Any} value value that the returned promise will be resolved with\n  Useful for tooling.\n  @return {Promise} a promise that will become fulfilled with the given\n  `value`\n*/\nfunction resolve$1(object) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (object && typeof object === 'object' && object.constructor === Constructor) {\n    return object;\n  }\n\n  var promise = new Constructor(noop);\n  resolve(promise, object);\n  return promise;\n}\n\nvar PROMISE_ID = Math.random().toString(36).substring(2);\n\nfunction noop() {}\n\nvar PENDING = void 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\n\nfunction selfFulfillment() {\n  return new TypeError(\"You cannot resolve a promise with itself\");\n}\n\nfunction cannotReturnOwn() {\n  return new TypeError('A promises callback cannot return that same promise.');\n}\n\nfunction tryThen(then$$1, value, fulfillmentHandler, rejectionHandler) {\n  try {\n    then$$1.call(value, fulfillmentHandler, rejectionHandler);\n  } catch (e) {\n    return e;\n  }\n}\n\nfunction handleForeignThenable(promise, thenable, then$$1) {\n  asap(function (promise) {\n    var sealed = false;\n    var error = tryThen(then$$1, thenable, function (value) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n      if (thenable !== value) {\n        resolve(promise, value);\n      } else {\n        fulfill(promise, value);\n      }\n    }, function (reason) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n\n      reject(promise, reason);\n    }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n    if (!sealed && error) {\n      sealed = true;\n      reject(promise, error);\n    }\n  }, promise);\n}\n\nfunction handleOwnThenable(promise, thenable) {\n  if (thenable._state === FULFILLED) {\n    fulfill(promise, thenable._result);\n  } else if (thenable._state === REJECTED) {\n    reject(promise, thenable._result);\n  } else {\n    subscribe(thenable, undefined, function (value) {\n      return resolve(promise, value);\n    }, function (reason) {\n      return reject(promise, reason);\n    });\n  }\n}\n\nfunction handleMaybeThenable(promise, maybeThenable, then$$1) {\n  if (maybeThenable.constructor === promise.constructor && then$$1 === then && maybeThenable.constructor.resolve === resolve$1) {\n    handleOwnThenable(promise, maybeThenable);\n  } else {\n    if (then$$1 === undefined) {\n      fulfill(promise, maybeThenable);\n    } else if (isFunction(then$$1)) {\n      handleForeignThenable(promise, maybeThenable, then$$1);\n    } else {\n      fulfill(promise, maybeThenable);\n    }\n  }\n}\n\nfunction resolve(promise, value) {\n  if (promise === value) {\n    reject(promise, selfFulfillment());\n  } else if (objectOrFunction(value)) {\n    var then$$1 = void 0;\n    try {\n      then$$1 = value.then;\n    } catch (error) {\n      reject(promise, error);\n      return;\n    }\n    handleMaybeThenable(promise, value, then$$1);\n  } else {\n    fulfill(promise, value);\n  }\n}\n\nfunction publishRejection(promise) {\n  if (promise._onerror) {\n    promise._onerror(promise._result);\n  }\n\n  publish(promise);\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n\n  promise._result = value;\n  promise._state = FULFILLED;\n\n  if (promise._subscribers.length !== 0) {\n    asap(publish, promise);\n  }\n}\n\nfunction reject(promise, reason) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n  promise._state = REJECTED;\n  promise._result = reason;\n\n  asap(publishRejection, promise);\n}\n\nfunction subscribe(parent, child, onFulfillment, onRejection) {\n  var _subscribers = parent._subscribers;\n  var length = _subscribers.length;\n\n\n  parent._onerror = null;\n\n  _subscribers[length] = child;\n  _subscribers[length + FULFILLED] = onFulfillment;\n  _subscribers[length + REJECTED] = onRejection;\n\n  if (length === 0 && parent._state) {\n    asap(publish, parent);\n  }\n}\n\nfunction publish(promise) {\n  var subscribers = promise._subscribers;\n  var settled = promise._state;\n\n  if (subscribers.length === 0) {\n    return;\n  }\n\n  var child = void 0,\n      callback = void 0,\n      detail = promise._result;\n\n  for (var i = 0; i < subscribers.length; i += 3) {\n    child = subscribers[i];\n    callback = subscribers[i + settled];\n\n    if (child) {\n      invokeCallback(settled, child, callback, detail);\n    } else {\n      callback(detail);\n    }\n  }\n\n  promise._subscribers.length = 0;\n}\n\nfunction invokeCallback(settled, promise, callback, detail) {\n  var hasCallback = isFunction(callback),\n      value = void 0,\n      error = void 0,\n      succeeded = true;\n\n  if (hasCallback) {\n    try {\n      value = callback(detail);\n    } catch (e) {\n      succeeded = false;\n      error = e;\n    }\n\n    if (promise === value) {\n      reject(promise, cannotReturnOwn());\n      return;\n    }\n  } else {\n    value = detail;\n  }\n\n  if (promise._state !== PENDING) {\n    // noop\n  } else if (hasCallback && succeeded) {\n    resolve(promise, value);\n  } else if (succeeded === false) {\n    reject(promise, error);\n  } else if (settled === FULFILLED) {\n    fulfill(promise, value);\n  } else if (settled === REJECTED) {\n    reject(promise, value);\n  }\n}\n\nfunction initializePromise(promise, resolver) {\n  try {\n    resolver(function resolvePromise(value) {\n      resolve(promise, value);\n    }, function rejectPromise(reason) {\n      reject(promise, reason);\n    });\n  } catch (e) {\n    reject(promise, e);\n  }\n}\n\nvar id = 0;\nfunction nextId() {\n  return id++;\n}\n\nfunction makePromise(promise) {\n  promise[PROMISE_ID] = id++;\n  promise._state = undefined;\n  promise._result = undefined;\n  promise._subscribers = [];\n}\n\nfunction validationError() {\n  return new Error('Array Methods must be provided an Array');\n}\n\nvar Enumerator = function () {\n  function Enumerator(Constructor, input) {\n    this._instanceConstructor = Constructor;\n    this.promise = new Constructor(noop);\n\n    if (!this.promise[PROMISE_ID]) {\n      makePromise(this.promise);\n    }\n\n    if (isArray(input)) {\n      this.length = input.length;\n      this._remaining = input.length;\n\n      this._result = new Array(this.length);\n\n      if (this.length === 0) {\n        fulfill(this.promise, this._result);\n      } else {\n        this.length = this.length || 0;\n        this._enumerate(input);\n        if (this._remaining === 0) {\n          fulfill(this.promise, this._result);\n        }\n      }\n    } else {\n      reject(this.promise, validationError());\n    }\n  }\n\n  Enumerator.prototype._enumerate = function _enumerate(input) {\n    for (var i = 0; this._state === PENDING && i < input.length; i++) {\n      this._eachEntry(input[i], i);\n    }\n  };\n\n  Enumerator.prototype._eachEntry = function _eachEntry(entry, i) {\n    var c = this._instanceConstructor;\n    var resolve$$1 = c.resolve;\n\n\n    if (resolve$$1 === resolve$1) {\n      var _then = void 0;\n      var error = void 0;\n      var didError = false;\n      try {\n        _then = entry.then;\n      } catch (e) {\n        didError = true;\n        error = e;\n      }\n\n      if (_then === then && entry._state !== PENDING) {\n        this._settledAt(entry._state, i, entry._result);\n      } else if (typeof _then !== 'function') {\n        this._remaining--;\n        this._result[i] = entry;\n      } else if (c === Promise$1) {\n        var promise = new c(noop);\n        if (didError) {\n          reject(promise, error);\n        } else {\n          handleMaybeThenable(promise, entry, _then);\n        }\n        this._willSettleAt(promise, i);\n      } else {\n        this._willSettleAt(new c(function (resolve$$1) {\n          return resolve$$1(entry);\n        }), i);\n      }\n    } else {\n      this._willSettleAt(resolve$$1(entry), i);\n    }\n  };\n\n  Enumerator.prototype._settledAt = function _settledAt(state, i, value) {\n    var promise = this.promise;\n\n\n    if (promise._state === PENDING) {\n      this._remaining--;\n\n      if (state === REJECTED) {\n        reject(promise, value);\n      } else {\n        this._result[i] = value;\n      }\n    }\n\n    if (this._remaining === 0) {\n      fulfill(promise, this._result);\n    }\n  };\n\n  Enumerator.prototype._willSettleAt = function _willSettleAt(promise, i) {\n    var enumerator = this;\n\n    subscribe(promise, undefined, function (value) {\n      return enumerator._settledAt(FULFILLED, i, value);\n    }, function (reason) {\n      return enumerator._settledAt(REJECTED, i, reason);\n    });\n  };\n\n  return Enumerator;\n}();\n\n/**\n  `Promise.all` accepts an array of promises, and returns a new promise which\n  is fulfilled with an array of fulfillment values for the passed promises, or\n  rejected with the reason of the first passed promise to be rejected. It casts all\n  elements of the passed iterable to promises as it runs this algorithm.\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = resolve(2);\n  let promise3 = resolve(3);\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // The array here would be [ 1, 2, 3 ];\n  });\n  ```\n\n  If any of the `promises` given to `all` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promises's\n  rejection handler. For example:\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = reject(new Error(\"2\"));\n  let promise3 = reject(new Error(\"3\"));\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(error) {\n    // error.message === \"2\"\n  });\n  ```\n\n  @method all\n  @static\n  @param {Array} entries array of promises\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled when all `promises` have been\n  fulfilled, or rejected if any of them become rejected.\n  @static\n*/\nfunction all(entries) {\n  return new Enumerator(this, entries).promise;\n}\n\n/**\n  `Promise.race` returns a new promise which is settled in the same way as the\n  first passed promise to settle.\n\n  Example:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 2');\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // result === 'promise 2' because it was resolved before promise1\n    // was resolved.\n  });\n  ```\n\n  `Promise.race` is deterministic in that only the state of the first\n  settled promise matters. For example, even if other promises given to the\n  `promises` array argument are resolved, but the first settled promise has\n  become rejected before the other promises became fulfilled, the returned\n  promise will become rejected:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      reject(new Error('promise 2'));\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // Code here never runs\n  }, function(reason){\n    // reason.message === 'promise 2' because promise 2 became rejected before\n    // promise 1 became fulfilled\n  });\n  ```\n\n  An example real-world use case is implementing timeouts:\n\n  ```javascript\n  Promise.race([ajax('foo.json'), timeout(5000)])\n  ```\n\n  @method race\n  @static\n  @param {Array} promises array of promises to observe\n  Useful for tooling.\n  @return {Promise} a promise which settles in the same way as the first passed\n  promise to settle.\n*/\nfunction race(entries) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (!isArray(entries)) {\n    return new Constructor(function (_, reject) {\n      return reject(new TypeError('You must pass an array to race.'));\n    });\n  } else {\n    return new Constructor(function (resolve, reject) {\n      var length = entries.length;\n      for (var i = 0; i < length; i++) {\n        Constructor.resolve(entries[i]).then(resolve, reject);\n      }\n    });\n  }\n}\n\n/**\n  `Promise.reject` returns a promise rejected with the passed `reason`.\n  It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    reject(new Error('WHOOPS'));\n  });\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.reject(new Error('WHOOPS'));\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  @method reject\n  @static\n  @param {Any} reason value that the returned promise will be rejected with.\n  Useful for tooling.\n  @return {Promise} a promise rejected with the given `reason`.\n*/\nfunction reject$1(reason) {\n  /*jshint validthis:true */\n  var Constructor = this;\n  var promise = new Constructor(noop);\n  reject(promise, reason);\n  return promise;\n}\n\nfunction needsResolver() {\n  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n}\n\nfunction needsNew() {\n  throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n}\n\n/**\n  Promise objects represent the eventual result of an asynchronous operation. The\n  primary way of interacting with a promise is through its `then` method, which\n  registers callbacks to receive either a promise's eventual value or the reason\n  why the promise cannot be fulfilled.\n\n  Terminology\n  -----------\n\n  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n  - `thenable` is an object or function that defines a `then` method.\n  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n  - `exception` is a value that is thrown using the throw statement.\n  - `reason` is a value that indicates why a promise was rejected.\n  - `settled` the final resting state of a promise, fulfilled or rejected.\n\n  A promise can be in one of three states: pending, fulfilled, or rejected.\n\n  Promises that are fulfilled have a fulfillment value and are in the fulfilled\n  state.  Promises that are rejected have a rejection reason and are in the\n  rejected state.  A fulfillment value is never a thenable.\n\n  Promises can also be said to *resolve* a value.  If this value is also a\n  promise, then the original promise's settled state will match the value's\n  settled state.  So a promise that *resolves* a promise that rejects will\n  itself reject, and a promise that *resolves* a promise that fulfills will\n  itself fulfill.\n\n\n  Basic Usage:\n  ------------\n\n  ```js\n  let promise = new Promise(function(resolve, reject) {\n    // on success\n    resolve(value);\n\n    // on failure\n    reject(reason);\n  });\n\n  promise.then(function(value) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Advanced Usage:\n  ---------------\n\n  Promises shine when abstracting away asynchronous interactions such as\n  `XMLHttpRequest`s.\n\n  ```js\n  function getJSON(url) {\n    return new Promise(function(resolve, reject){\n      let xhr = new XMLHttpRequest();\n\n      xhr.open('GET', url);\n      xhr.onreadystatechange = handler;\n      xhr.responseType = 'json';\n      xhr.setRequestHeader('Accept', 'application/json');\n      xhr.send();\n\n      function handler() {\n        if (this.readyState === this.DONE) {\n          if (this.status === 200) {\n            resolve(this.response);\n          } else {\n            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n          }\n        }\n      };\n    });\n  }\n\n  getJSON('/posts.json').then(function(json) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Unlike callbacks, promises are great composable primitives.\n\n  ```js\n  Promise.all([\n    getJSON('/posts'),\n    getJSON('/comments')\n  ]).then(function(values){\n    values[0] // => postsJSON\n    values[1] // => commentsJSON\n\n    return values;\n  });\n  ```\n\n  @class Promise\n  @param {Function} resolver\n  Useful for tooling.\n  @constructor\n*/\n\nvar Promise$1 = function () {\n  function Promise(resolver) {\n    this[PROMISE_ID] = nextId();\n    this._result = this._state = undefined;\n    this._subscribers = [];\n\n    if (noop !== resolver) {\n      typeof resolver !== 'function' && needsResolver();\n      this instanceof Promise ? initializePromise(this, resolver) : needsNew();\n    }\n  }\n\n  /**\n  The primary way of interacting with a promise is through its `then` method,\n  which registers callbacks to receive either a promise's eventual value or the\n  reason why the promise cannot be fulfilled.\n   ```js\n  findUser().then(function(user){\n    // user is available\n  }, function(reason){\n    // user is unavailable, and you are given the reason why\n  });\n  ```\n   Chaining\n  --------\n   The return value of `then` is itself a promise.  This second, 'downstream'\n  promise is resolved with the return value of the first promise's fulfillment\n  or rejection handler, or rejected if the handler throws an exception.\n   ```js\n  findUser().then(function (user) {\n    return user.name;\n  }, function (reason) {\n    return 'default name';\n  }).then(function (userName) {\n    // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n    // will be `'default name'`\n  });\n   findUser().then(function (user) {\n    throw new Error('Found user, but still unhappy');\n  }, function (reason) {\n    throw new Error('`findUser` rejected and we're unhappy');\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n    // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\n  });\n  ```\n  If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n   ```js\n  findUser().then(function (user) {\n    throw new PedagogicalException('Upstream error');\n  }).then(function (value) {\n    // never reached\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // The `PedgagocialException` is propagated all the way down to here\n  });\n  ```\n   Assimilation\n  ------------\n   Sometimes the value you want to propagate to a downstream promise can only be\n  retrieved asynchronously. This can be achieved by returning a promise in the\n  fulfillment or rejection handler. The downstream promise will then be pending\n  until the returned promise is settled. This is called *assimilation*.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // The user's comments are now available\n  });\n  ```\n   If the assimliated promise rejects, then the downstream promise will also reject.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // If `findCommentsByAuthor` fulfills, we'll have the value here\n  }, function (reason) {\n    // If `findCommentsByAuthor` rejects, we'll have the reason here\n  });\n  ```\n   Simple Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let result;\n   try {\n    result = findResult();\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n  findResult(function(result, err){\n    if (err) {\n      // failure\n    } else {\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findResult().then(function(result){\n    // success\n  }, function(reason){\n    // failure\n  });\n  ```\n   Advanced Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let author, books;\n   try {\n    author = findAuthor();\n    books  = findBooksByAuthor(author);\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n   function foundBooks(books) {\n   }\n   function failure(reason) {\n   }\n   findAuthor(function(author, err){\n    if (err) {\n      failure(err);\n      // failure\n    } else {\n      try {\n        findBoooksByAuthor(author, function(books, err) {\n          if (err) {\n            failure(err);\n          } else {\n            try {\n              foundBooks(books);\n            } catch(reason) {\n              failure(reason);\n            }\n          }\n        });\n      } catch(error) {\n        failure(err);\n      }\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findAuthor().\n    then(findBooksByAuthor).\n    then(function(books){\n      // found books\n  }).catch(function(reason){\n    // something went wrong\n  });\n  ```\n   @method then\n  @param {Function} onFulfilled\n  @param {Function} onRejected\n  Useful for tooling.\n  @return {Promise}\n  */\n\n  /**\n  `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n  as the catch block of a try/catch statement.\n  ```js\n  function findAuthor(){\n  throw new Error('couldn't find that author');\n  }\n  // synchronous\n  try {\n  findAuthor();\n  } catch(reason) {\n  // something went wrong\n  }\n  // async with promises\n  findAuthor().catch(function(reason){\n  // something went wrong\n  });\n  ```\n  @method catch\n  @param {Function} onRejection\n  Useful for tooling.\n  @return {Promise}\n  */\n\n\n  Promise.prototype.catch = function _catch(onRejection) {\n    return this.then(null, onRejection);\n  };\n\n  /**\n    `finally` will be invoked regardless of the promise's fate just as native\n    try/catch/finally behaves\n  \n    Synchronous example:\n  \n    ```js\n    findAuthor() {\n      if (Math.random() > 0.5) {\n        throw new Error();\n      }\n      return new Author();\n    }\n  \n    try {\n      return findAuthor(); // succeed or fail\n    } catch(error) {\n      return findOtherAuther();\n    } finally {\n      // always runs\n      // doesn't affect the return value\n    }\n    ```\n  \n    Asynchronous example:\n  \n    ```js\n    findAuthor().catch(function(reason){\n      return findOtherAuther();\n    }).finally(function(){\n      // author was either found, or not\n    });\n    ```\n  \n    @method finally\n    @param {Function} callback\n    @return {Promise}\n  */\n\n\n  Promise.prototype.finally = function _finally(callback) {\n    var promise = this;\n    var constructor = promise.constructor;\n\n    if (isFunction(callback)) {\n      return promise.then(function (value) {\n        return constructor.resolve(callback()).then(function () {\n          return value;\n        });\n      }, function (reason) {\n        return constructor.resolve(callback()).then(function () {\n          throw reason;\n        });\n      });\n    }\n\n    return promise.then(callback, callback);\n  };\n\n  return Promise;\n}();\n\nPromise$1.prototype.then = then;\nPromise$1.all = all;\nPromise$1.race = race;\nPromise$1.resolve = resolve$1;\nPromise$1.reject = reject$1;\nPromise$1._setScheduler = setScheduler;\nPromise$1._setAsap = setAsap;\nPromise$1._asap = asap;\n\n/*global self*/\nfunction polyfill() {\n  var local = void 0;\n\n  if (typeof global !== 'undefined') {\n    local = global;\n  } else if (typeof self !== 'undefined') {\n    local = self;\n  } else {\n    try {\n      local = Function('return this')();\n    } catch (e) {\n      throw new Error('polyfill failed because global object is unavailable in this environment');\n    }\n  }\n\n  var P = local.Promise;\n\n  if (P) {\n    var promiseToString = null;\n    try {\n      promiseToString = Object.prototype.toString.call(P.resolve());\n    } catch (e) {\n      // silently ignored\n    }\n\n    if (promiseToString === '[object Promise]' && !P.cast) {\n      return;\n    }\n  }\n\n  local.Promise = Promise$1;\n}\n\n// Strange compat..\nPromise$1.polyfill = polyfill;\nPromise$1.Promise = Promise$1;\n\nreturn Promise$1;\n\n})));\n\n\n\n//# sourceMappingURL=es6-promise.map\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar objectCreate = Object.create || objectCreatePolyfill\nvar objectKeys = Object.keys || objectKeysPolyfill\nvar bind = Function.prototype.bind || functionBindPolyfill\n\nfunction EventEmitter() {\n  if (!this._events || !Object.prototype.hasOwnProperty.call(this, '_events')) {\n    this._events = objectCreate(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nvar hasDefineProperty;\ntry {\n  var o = {};\n  if (Object.defineProperty) Object.defineProperty(o, 'x', { value: 0 });\n  hasDefineProperty = o.x === 0;\n} catch (err) { hasDefineProperty = false }\nif (hasDefineProperty) {\n  Object.defineProperty(EventEmitter, 'defaultMaxListeners', {\n    enumerable: true,\n    get: function() {\n      return defaultMaxListeners;\n    },\n    set: function(arg) {\n      // check whether the input is a positive number (whose value is zero or\n      // greater and not a NaN).\n      if (typeof arg !== 'number' || arg < 0 || arg !== arg)\n        throw new TypeError('\"defaultMaxListeners\" must be a positive number');\n      defaultMaxListeners = arg;\n    }\n  });\n} else {\n  EventEmitter.defaultMaxListeners = defaultMaxListeners;\n}\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || isNaN(n))\n    throw new TypeError('\"n\" argument must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nfunction $getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return $getMaxListeners(this);\n};\n\n// These standalone emit* functions are used to optimize calling of event\n// handlers for fast cases because emit() itself often has a variable number of\n// arguments and can be deoptimized because of that. These functions always have\n// the same number of arguments and thus do not get deoptimized, so the code\n// inside them can execute faster.\nfunction emitNone(handler, isFn, self) {\n  if (isFn)\n    handler.call(self);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self);\n  }\n}\nfunction emitOne(handler, isFn, self, arg1) {\n  if (isFn)\n    handler.call(self, arg1);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1);\n  }\n}\nfunction emitTwo(handler, isFn, self, arg1, arg2) {\n  if (isFn)\n    handler.call(self, arg1, arg2);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1, arg2);\n  }\n}\nfunction emitThree(handler, isFn, self, arg1, arg2, arg3) {\n  if (isFn)\n    handler.call(self, arg1, arg2, arg3);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1, arg2, arg3);\n  }\n}\n\nfunction emitMany(handler, isFn, self, args) {\n  if (isFn)\n    handler.apply(self, args);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].apply(self, args);\n  }\n}\n\nEventEmitter.prototype.emit = function emit(type) {\n  var er, handler, len, args, i, events;\n  var doError = (type === 'error');\n\n  events = this._events;\n  if (events)\n    doError = (doError && events.error == null);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    if (arguments.length > 1)\n      er = arguments[1];\n    if (er instanceof Error) {\n      throw er; // Unhandled 'error' event\n    } else {\n      // At least give some kind of context to the user\n      var err = new Error('Unhandled \"error\" event. (' + er + ')');\n      err.context = er;\n      throw err;\n    }\n    return false;\n  }\n\n  handler = events[type];\n\n  if (!handler)\n    return false;\n\n  var isFn = typeof handler === 'function';\n  len = arguments.length;\n  switch (len) {\n      // fast cases\n    case 1:\n      emitNone(handler, isFn, this);\n      break;\n    case 2:\n      emitOne(handler, isFn, this, arguments[1]);\n      break;\n    case 3:\n      emitTwo(handler, isFn, this, arguments[1], arguments[2]);\n      break;\n    case 4:\n      emitThree(handler, isFn, this, arguments[1], arguments[2], arguments[3]);\n      break;\n      // slower\n    default:\n      args = new Array(len - 1);\n      for (i = 1; i < len; i++)\n        args[i - 1] = arguments[i];\n      emitMany(handler, isFn, this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  if (typeof listener !== 'function')\n    throw new TypeError('\"listener\" argument must be a function');\n\n  events = target._events;\n  if (!events) {\n    events = target._events = objectCreate(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener) {\n      target.emit('newListener', type,\n          listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (!existing) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n          prepend ? [listener, existing] : [existing, listener];\n    } else {\n      // If we've already got an array, just append.\n      if (prepend) {\n        existing.unshift(listener);\n      } else {\n        existing.push(listener);\n      }\n    }\n\n    // Check for listener leak\n    if (!existing.warned) {\n      m = $getMaxListeners(target);\n      if (m && m > 0 && existing.length > m) {\n        existing.warned = true;\n        var w = new Error('Possible EventEmitter memory leak detected. ' +\n            existing.length + ' \"' + String(type) + '\" listeners ' +\n            'added. Use emitter.setMaxListeners() to ' +\n            'increase limit.');\n        w.name = 'MaxListenersExceededWarning';\n        w.emitter = target;\n        w.type = type;\n        w.count = existing.length;\n        if (typeof console === 'object' && console.warn) {\n          console.warn('%s: %s', w.name, w.message);\n        }\n      }\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    switch (arguments.length) {\n      case 0:\n        return this.listener.call(this.target);\n      case 1:\n        return this.listener.call(this.target, arguments[0]);\n      case 2:\n        return this.listener.call(this.target, arguments[0], arguments[1]);\n      case 3:\n        return this.listener.call(this.target, arguments[0], arguments[1],\n            arguments[2]);\n      default:\n        var args = new Array(arguments.length);\n        for (var i = 0; i < args.length; ++i)\n          args[i] = arguments[i];\n        this.listener.apply(this.target, args);\n    }\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = bind.call(onceWrapper, state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  if (typeof listener !== 'function')\n    throw new TypeError('\"listener\" argument must be a function');\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      if (typeof listener !== 'function')\n        throw new TypeError('\"listener\" argument must be a function');\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      if (typeof listener !== 'function')\n        throw new TypeError('\"listener\" argument must be a function');\n\n      events = this._events;\n      if (!events)\n        return this;\n\n      list = events[type];\n      if (!list)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = objectCreate(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else\n          spliceOne(list, position);\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (!events)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (!events.removeListener) {\n        if (arguments.length === 0) {\n          this._events = objectCreate(null);\n          this._eventsCount = 0;\n        } else if (events[type]) {\n          if (--this._eventsCount === 0)\n            this._events = objectCreate(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = objectKeys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = objectCreate(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (!events)\n    return [];\n\n  var evlistener = events[type];\n  if (!evlistener)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ? unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? Reflect.ownKeys(this._events) : [];\n};\n\n// About 1.5x faster than the two-arg version of Array#splice().\nfunction spliceOne(list, index) {\n  for (var i = index, k = i + 1, n = list.length; k < n; i += 1, k += 1)\n    list[i] = list[k];\n  list.pop();\n}\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction objectCreatePolyfill(proto) {\n  var F = function() {};\n  F.prototype = proto;\n  return new F;\n}\nfunction objectKeysPolyfill(obj) {\n  var keys = [];\n  for (var k in obj) if (Object.prototype.hasOwnProperty.call(obj, k)) {\n    keys.push(k);\n  }\n  return k;\n}\nfunction functionBindPolyfill(context) {\n  var fn = this;\n  return function () {\n    return fn.apply(context, arguments);\n  };\n}\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","const PCMPlayer = (function () {\n    function PCMPlayer(option) {\n        let defaults = {\n            encoding: '32bitFloat',\n            // channels: 1,\n            // sampleRate: 44100,\n            flushingTime: 1000\n        };\n        this.option = Object.assign({}, defaults, option);\n        this.samples = new Float32Array();\n        this.sampleRate = null;\n        this.flush = this.flush.bind(this);\n        this.interval = setInterval(this.flush, this.option.flushingTime);\n        this.maxValue = this.getMaxValue();\n        this.typedArray = this.getTypedArray();\n        this.createContext();\n        this.flush();\n\n\n    }\n\n    PCMPlayer.prototype.getMaxValue = function () {\n        let encodings = {\n            '8bitInt': 128,\n            '16bitInt': 32768,\n            '32bitInt': 2147483648,\n            '32bitFloat': 1\n        };\n\n        return encodings[this.option.encoding] ? encodings[this.option.encoding] : encodings['16bitInt'];\n    };\n\n    PCMPlayer.prototype.getTypedArray = function () {\n        let typedArrays = {\n            '8bitInt': Int8Array,\n            '16bitInt': Int16Array,\n            '32bitInt': Int32Array,\n            '32bitFloat': Float32Array\n        };\n\n        return typedArrays[this.option.encoding] ? typedArrays[this.option.encoding] : typedArrays['16bitInt'];\n    };\n\n    PCMPlayer.prototype.createContext = function () {\n        this.audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n        window.audioCtx = this.audioCtx;\n        this.gainNode = this.audioCtx.createGain();\n        this.gainNode.gain.value = 1;\n        this.gainNode.connect(this.audioCtx.destination);\n        this.startTime = this.audioCtx.currentTime;\n    };\n\n    PCMPlayer.prototype.isTypedArray = function (data) {\n        return (data.byteLength && data.buffer && data.buffer.constructor == ArrayBuffer);\n    };\n\n    PCMPlayer.prototype.feed = function (data) {\n        if (!this.isTypedArray(data)) return;\n        data = new this.typedArray(data.buffer);\n        // console.log(this.samples.length)\n        // console.log('this.samples.length', this.samples.length)\n        let tmp = new Float32Array(this.samples.length + data.length);\n        tmp.set(this.samples, 0);\n        tmp.set(data, this.samples.length);\n        this.samples = tmp;\n        // console.log(this.samples)\n    };\n\n    PCMPlayer.prototype.clean = function () {\n        this.samples = new this.typedArray();\n    };\n\n    PCMPlayer.prototype.getFormatedValue = function (data) {\n        let final = new this.typedArray(data.buffer),\n            float32 = new Float32Array(data.length),\n            i;\n        // for (i = 0; i < data.length; i++) {\n        //     float32[i] = data[i] / this.maxValue;\n        //     \n        // }\n        float32.set(final, 0);\n        return float32;\n    };\n\n    PCMPlayer.prototype.volume = function (volume) {\n        this.gainNode.gain.value = volume;\n    };\n\n    PCMPlayer.prototype.destroy = function () {\n        if (this.interval) {\n            clearInterval(this.interval);\n        }\n        this.samples = null;\n        this.audioCtx.close();\n        this.audioCtx = null;\n        window.audioCtx = null;\n    };\n\n    PCMPlayer.prototype.flush = function () {\n        // console.log('-------------flush')\n        if (!this.samples.length) return;\n        let bufferSource = this.audioCtx.createBufferSource(),\n            length = this.samples.length / this.option.channels,\n            audioBuffer = this.audioCtx.createBuffer(this.option.channels, length, this.sampleRate),\n            audioData,\n            channel,\n            offset,\n            i,\n            decrement;\n\n        for (channel = 0; channel < this.option.channels; channel++) {\n            audioData = audioBuffer.getChannelData(channel);\n            offset = channel;\n            decrement = 50;\n            for (i = 0; i < length; i++) {\n                audioData[i] = this.samples[offset];\n                /* fadein */\n                if (i < 50) {\n                    audioData[i] = (audioData[i] * i) / 50;\n                }\n                /* fadeout*/\n                if (i >= (length - 51)) {\n                    audioData[i] = (audioData[i] * decrement--) / 50;\n                }\n                offset += this.option.channels;\n            }\n        }\n\n        if (this.startTime < this.audioCtx.currentTime) {\n            this.startTime = this.audioCtx.currentTime;\n        }\n        // console.log('start vs current ' + this.startTime + ' vs ' + this.audioCtx.currentTime + ' duration: ' + audioBuffer.duration);\n\n        bufferSource.buffer = audioBuffer;\n        bufferSource.connect(this.gainNode);\n        bufferSource.start(this.startTime);\n        this.startTime += audioBuffer.duration;\n        this.samples = new Float32Array();\n    };\n    return PCMPlayer;\n})();\n\nexport default PCMPlayer;","/*\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\n *\n * @author zheng qian <xqq@xqq.im>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nclass MediaInfo {\n\n    constructor() {\n        this.mimeType = null;\n        this.duration = null;\n\n        this.hasAudio = null;\n        this.hasVideo = null;\n        this.audioCodec = null;\n        this.videoCodec = null;\n        this.audioDataRate = null;\n        this.videoDataRate = null;\n\n        this.audioSampleRate = null;\n        this.audioChannelCount = null;\n\n        this.width = null;\n        this.height = null;\n        this.fps = null;\n        this.profile = null;\n        this.level = null;\n        this.refFrames = null;\n        this.chromaFormat = null;\n        this.sarNum = null;\n        this.sarDen = null;\n\n        this.metadata = null;\n        this.segments = null;  // MediaInfo[]\n        this.segmentCount = null;\n        this.hasKeyframesIndex = null;\n        this.keyframesIndex = null;\n    }\n\n    isComplete() {\n        let audioInfoComplete = (this.hasAudio === false) ||\n                                (this.hasAudio === true &&\n                                 this.audioCodec != null &&\n                                 this.audioSampleRate != null &&\n                                 this.audioChannelCount != null);\n\n        let videoInfoComplete = (this.hasVideo === false) ||\n                                (this.hasVideo === true &&\n                                 this.videoCodec != null &&\n                                 this.width != null &&\n                                 this.height != null &&\n                                 this.fps != null &&\n                                 this.profile != null &&\n                                 this.level != null &&\n                                 this.refFrames != null &&\n                                 this.chromaFormat != null &&\n                                 this.sarNum != null &&\n                                 this.sarDen != null);\n\n        // keyframesIndex may not be present\n        return this.mimeType != null &&\n               this.duration != null &&\n               this.metadata != null &&\n               this.hasKeyframesIndex != null &&\n               audioInfoComplete &&\n               videoInfoComplete;\n    }\n\n    isSeekable() {\n        return this.hasKeyframesIndex === true;\n    }\n\n    getNearestKeyframe(milliseconds) {\n        if (this.keyframesIndex == null) {\n            return null;\n        }\n\n        let table = this.keyframesIndex;\n        let keyframeIdx = this._search(table.times, milliseconds);\n\n        return {\n            index: keyframeIdx,\n            milliseconds: table.times[keyframeIdx],\n            fileposition: table.filepositions[keyframeIdx]\n        };\n    }\n\n    _search(list, value) {\n        let idx = 0;\n\n        let last = list.length - 1;\n        let mid = 0;\n        let lbound = 0;\n        let ubound = last;\n\n        if (value < list[0]) {\n            idx = 0;\n            lbound = ubound + 1;  // skip search\n        }\n\n        while (lbound <= ubound) {\n            mid = lbound + Math.floor((ubound - lbound) / 2);\n            if (mid === last || (value >= list[mid] && value < list[mid + 1])) {\n                idx = mid;\n                break;\n            } else if (list[mid] < value) {\n                lbound = mid + 1;\n            } else {\n                ubound = mid - 1;\n            }\n        }\n\n        return idx;\n    }\n\n}\n\nexport default MediaInfo;","/*\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\n *\n * @author zheng qian <xqq@xqq.im>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Log from '../utils/logger.js';\nimport decodeUTF8 from '../utils/utf8-conv.js';\nimport {IllegalStateException} from '../utils/exception.js';\n\nlet le = (function () {\n    let buf = new ArrayBuffer(2);\n    (new DataView(buf)).setInt16(0, 256, true);  // little-endian write\n    return (new Int16Array(buf))[0] === 256;  // platform-spec read, if equal then LE\n})();\n\nclass AMF {\n\n    static parseScriptData(arrayBuffer, dataOffset, dataSize) {\n        let data = {};\n\n        try {\n            let name = AMF.parseValue(arrayBuffer, dataOffset, dataSize);\n            let value = AMF.parseValue(arrayBuffer, dataOffset + name.size, dataSize - name.size);\n\n            data[name.data] = value.data;\n        } catch (e) {\n            Log.e('AMF', e.toString());\n        }\n\n        return data;\n    }\n\n    static parseObject(arrayBuffer, dataOffset, dataSize) {\n        if (dataSize < 3) {\n            throw new IllegalStateException('Data not enough when parse ScriptDataObject');\n        }\n        let name = AMF.parseString(arrayBuffer, dataOffset, dataSize);\n        let value = AMF.parseValue(arrayBuffer, dataOffset + name.size, dataSize - name.size);\n        let isObjectEnd = value.objectEnd;\n\n        return {\n            data: {\n                name: name.data,\n                value: value.data\n            },\n            size: name.size + value.size,\n            objectEnd: isObjectEnd\n        };\n    }\n\n    static parseVariable(arrayBuffer, dataOffset, dataSize) {\n        return AMF.parseObject(arrayBuffer, dataOffset, dataSize);\n    }\n\n    static parseString(arrayBuffer, dataOffset, dataSize) {\n        if (dataSize < 2) {\n            throw new IllegalStateException('Data not enough when parse String');\n        }\n        let v = new DataView(arrayBuffer, dataOffset, dataSize);\n        let length = v.getUint16(0, !le);\n\n        let str;\n        if (length > 0) {\n            str = decodeUTF8(new Uint8Array(arrayBuffer, dataOffset + 2, length));\n        } else {\n            str = '';\n        }\n\n        return {\n            data: str,\n            size: 2 + length\n        };\n    }\n\n    static parseLongString(arrayBuffer, dataOffset, dataSize) {\n        if (dataSize < 4) {\n            throw new IllegalStateException('Data not enough when parse LongString');\n        }\n        let v = new DataView(arrayBuffer, dataOffset, dataSize);\n        let length = v.getUint32(0, !le);\n\n        let str;\n        if (length > 0) {\n            str = decodeUTF8(new Uint8Array(arrayBuffer, dataOffset + 4, length));\n        } else {\n            str = '';\n        }\n\n        return {\n            data: str,\n            size: 4 + length\n        };\n    }\n\n    static parseDate(arrayBuffer, dataOffset, dataSize) {\n        if (dataSize < 10) {\n            throw new IllegalStateException('Data size invalid when parse Date');\n        }\n        let v = new DataView(arrayBuffer, dataOffset, dataSize);\n        let timestamp = v.getFloat64(0, !le);\n        let localTimeOffset = v.getInt16(8, !le);\n        timestamp += localTimeOffset * 60 * 1000;  // get UTC time\n\n        return {\n            data: new Date(timestamp),\n            size: 8 + 2\n        };\n    }\n\n    static parseValue(arrayBuffer, dataOffset, dataSize) {\n        if (dataSize < 1) {\n            throw new IllegalStateException('Data not enough when parse Value');\n        }\n\n        let v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n        let offset = 1;\n        let type = v.getUint8(0);\n        let value;\n        let objectEnd = false;\n\n        try {\n            switch (type) {\n                case 0:  // Number(Double) type\n                    value = v.getFloat64(1, !le);\n                    offset += 8;\n                    break;\n                case 1: {  // Boolean type\n                    let b = v.getUint8(1);\n                    value = b ? true : false;\n                    offset += 1;\n                    break;\n                }\n                case 2: {  // String type\n                    let amfstr = AMF.parseString(arrayBuffer, dataOffset + 1, dataSize - 1);\n                    value = amfstr.data;\n                    offset += amfstr.size;\n                    break;\n                }\n                case 3: { // Object(s) type\n                    value = {};\n                    let terminal = 0;  // workaround for malformed Objects which has missing ScriptDataObjectEnd\n                    if ((v.getUint32(dataSize - 4, !le) & 0x00FFFFFF) === 9) {\n                        terminal = 3;\n                    }\n                    while (offset < dataSize - 4) {  // 4 === type(UI8) + ScriptDataObjectEnd(UI24)\n                        let amfobj = AMF.parseObject(arrayBuffer, dataOffset + offset, dataSize - offset - terminal);\n                        if (amfobj.objectEnd)\n                            break;\n                        value[amfobj.data.name] = amfobj.data.value;\n                        offset += amfobj.size;\n                    }\n                    if (offset <= dataSize - 3) {\n                        let marker = v.getUint32(offset - 1, !le) & 0x00FFFFFF;\n                        if (marker === 9) {\n                            offset += 3;\n                        }\n                    }\n                    break;\n                }\n                case 8: { // ECMA array type (Mixed array)\n                    value = {};\n                    offset += 4;  // ECMAArrayLength(UI32)\n                    let terminal = 0;  // workaround for malformed MixedArrays which has missing ScriptDataObjectEnd\n                    if ((v.getUint32(dataSize - 4, !le) & 0x00FFFFFF) === 9) {\n                        terminal = 3;\n                    }\n                    while (offset < dataSize - 8) {  // 8 === type(UI8) + ECMAArrayLength(UI32) + ScriptDataVariableEnd(UI24)\n                        let amfvar = AMF.parseVariable(arrayBuffer, dataOffset + offset, dataSize - offset - terminal);\n                        if (amfvar.objectEnd)\n                            break;\n                        value[amfvar.data.name] = amfvar.data.value;\n                        offset += amfvar.size;\n                    }\n                    if (offset <= dataSize - 3) {\n                        let marker = v.getUint32(offset - 1, !le) & 0x00FFFFFF;\n                        if (marker === 9) {\n                            offset += 3;\n                        }\n                    }\n                    break;\n                }\n                case 9:  // ScriptDataObjectEnd\n                    value = undefined;\n                    offset = 1;\n                    objectEnd = true;\n                    break;\n                case 10: {  // Strict array type\n                    // ScriptDataValue[n]. NOTE: according to video_file_format_spec_v10_1.pdf\n                    value = [];\n                    let strictArrayLength = v.getUint32(1, !le);\n                    offset += 4;\n                    for (let i = 0; i < strictArrayLength; i++) {\n                        let val = AMF.parseValue(arrayBuffer, dataOffset + offset, dataSize - offset);\n                        value.push(val.data);\n                        offset += val.size;\n                    }\n                    break;\n                }\n                case 11: {  // Date type\n                    let date = AMF.parseDate(arrayBuffer, dataOffset + 1, dataSize - 1);\n                    value = date.data;\n                    offset += date.size;\n                    break;\n                }\n                case 12: {  // Long string type\n                    let amfLongStr = AMF.parseString(arrayBuffer, dataOffset + 1, dataSize - 1);\n                    value = amfLongStr.data;\n                    offset += amfLongStr.size;\n                    break;\n                }\n                default:\n                    // ignore and skip\n                    offset = dataSize;\n                    Log.w('AMF', 'Unsupported AMF value type ' + type);\n            }\n        } catch (e) {\n            Log.e('AMF', e.toString());\n        }\n\n        return {\n            data: value,\n            size: offset,\n            objectEnd: objectEnd\n        };\n    }\n\n}\n\nexport default AMF;","/*\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\n *\n * @author zheng qian <xqq@xqq.im>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst DemuxErrors = {\n    OK: 'OK',\n    FORMAT_ERROR: 'FormatError',\n    FORMAT_UNSUPPORTED: 'FormatUnsupported',\n    CODEC_UNSUPPORTED: 'CodecUnsupported'\n};\n\nexport default DemuxErrors;","/*\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\n *\n * @author zheng qian <xqq@xqq.im>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {IllegalStateException, InvalidArgumentException} from '../utils/exception.js';\n\n// Exponential-Golomb buffer decoder\nclass ExpGolomb {\n\n    constructor(uint8array) {\n        this.TAG = 'ExpGolomb';\n\n        this._buffer = uint8array;\n        this._buffer_index = 0;\n        this._total_bytes = uint8array.byteLength;\n        this._total_bits = uint8array.byteLength * 8;\n        this._current_word = 0;\n        this._current_word_bits_left = 0;\n    }\n\n    destroy() {\n        this._buffer = null;\n    }\n\n    _fillCurrentWord() {\n        let buffer_bytes_left = this._total_bytes - this._buffer_index;\n        if (buffer_bytes_left <= 0)\n            throw new IllegalStateException('ExpGolomb: _fillCurrentWord() but no bytes available');\n\n        let bytes_read = Math.min(4, buffer_bytes_left);\n        let word = new Uint8Array(4);\n        word.set(this._buffer.subarray(this._buffer_index, this._buffer_index + bytes_read));\n        this._current_word = new DataView(word.buffer).getUint32(0, false);\n\n        this._buffer_index += bytes_read;\n        this._current_word_bits_left = bytes_read * 8;\n    }\n\n    readBits(bits) {\n        if (bits > 32)\n            throw new InvalidArgumentException('ExpGolomb: readBits() bits exceeded max 32bits!');\n\n        if (bits <= this._current_word_bits_left) {\n            let result = this._current_word >>> (32 - bits);\n            this._current_word <<= bits;\n            this._current_word_bits_left -= bits;\n            return result;\n        }\n\n        let result = this._current_word_bits_left ? this._current_word : 0;\n        result = result >>> (32 - this._current_word_bits_left);\n        let bits_need_left = bits - this._current_word_bits_left;\n\n        this._fillCurrentWord();\n        let bits_read_next = Math.min(bits_need_left, this._current_word_bits_left);\n\n        let result2 = this._current_word >>> (32 - bits_read_next);\n        this._current_word <<= bits_read_next;\n        this._current_word_bits_left -= bits_read_next;\n\n        result = (result << bits_read_next) | result2;\n        return result;\n    }\n\n    readBool() {\n        return this.readBits(1) === 1;\n    }\n\n    readByte() {\n        return this.readBits(8);\n    }\n\n    _skipLeadingZero() {\n        let zero_count;\n        for (zero_count = 0; zero_count < this._current_word_bits_left; zero_count++) {\n            if (0 !== (this._current_word & (0x80000000 >>> zero_count))) {\n                this._current_word <<= zero_count;\n                this._current_word_bits_left -= zero_count;\n                return zero_count;\n            }\n        }\n        this._fillCurrentWord();\n        return zero_count + this._skipLeadingZero();\n    }\n\n    readUEG() {  // unsigned exponential golomb\n        let leading_zeros = this._skipLeadingZero();\n        return this.readBits(leading_zeros + 1) - 1;\n    }\n\n    readSEG() {  // signed exponential golomb\n        let value = this.readUEG();\n        if (value & 0x01) {\n            return (value + 1) >>> 1;\n        } else {\n            return -1 * (value >>> 1);\n        }\n    }\n\n}\n\nexport default ExpGolomb;","/*\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\n *\n * @author zheng qian <xqq@xqq.im>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Log from '../utils/logger.js';\nimport AMF from './amf-parser.js';\nimport SPSParser from './sps-parser.js';\nimport DemuxErrors from './demux-errors.js';\nimport MediaInfo from '../core/media-info.js';\nimport { IllegalStateException } from '../utils/exception.js';\nfunction _toConsumableArray(arr) {\n    if (Array.isArray(arr)) {\n        let arr2  =  Array(arr.length);\n        for (let i = 0; i < arr.length; i++) {\n            arr2[i] = arr[i];\n        }\n        return arr2;\n    } else {\n        return Array.from(arr);\n    }\n}\n\nfunction Swap16(src) {\n    return (((src >>> 8) & 0xFF) |\n        ((src & 0xFF) << 8));\n}\n\nfunction Swap32(src) {\n    return (((src & 0xFF000000) >>> 24) |\n        ((src & 0x00FF0000) >>> 8) |\n        ((src & 0x0000FF00) << 8) |\n        ((src & 0x000000FF) << 24));\n}\n\nfunction ReadBig32(array, index) {\n    return ((array[index] << 24) |\n        (array[index + 1] << 16) |\n        (array[index + 2] << 8) |\n        (array[index + 3]));\n}\n\n\nclass FLVDemuxer {\n\n    constructor(probeData, config) {\n        this.TAG = 'FLVDemuxer';\n\n        this._config = config;\n\n        this._onError = null;\n        this._onMediaInfo = null;\n        this._onMetaDataArrived = null;\n        this._onScriptDataArrived = null;\n        this._onTrackMetadata = null;\n        this._onDataAvailable = null;\n\n        this._dataOffset = probeData.dataOffset;\n        this._firstParse = true;\n        this._dispatch = false;\n\n        this._hasAudio = probeData.hasAudioTrack;\n        this._hasVideo = probeData.hasVideoTrack;\n\n        this._hasAudioFlagOverrided = false;\n        this._hasVideoFlagOverrided = false;\n\n        this._audioInitialMetadataDispatched = false;\n        this._videoInitialMetadataDispatched = false;\n\n        this._mediaInfo = new MediaInfo();\n        this._mediaInfo.hasAudio = this._hasAudio;\n        this._mediaInfo.hasVideo = this._hasVideo;\n        this._metadata = null;\n        this._audioMetadata = null;\n        this._videoMetadata = null;\n\n        this._naluLengthSize = 4;\n        this._timestampBase = 0;  // int32, in milliseconds\n        this._timescale = 1000;\n        this._duration = 0;  // int32, in milliseconds\n        this._durationOverrided = false;\n        this._referenceFrameRate = {\n            fixed: true,\n            fps: 23.976,\n            fps_num: 23976,\n            fps_den: 1000\n        };\n\n        this._flvSoundRateTable = [5500, 11025, 22050, 44100, 48000];\n\n        this._mpegSamplingRates = [\n            96000, 88200, 64000, 48000, 44100, 32000,\n            24000, 22050, 16000, 12000, 11025, 8000, 7350\n        ];\n\n        this._mpegAudioV10SampleRateTable = [44100, 48000, 32000, 0];\n        this._mpegAudioV20SampleRateTable = [22050, 24000, 16000, 0];\n        this._mpegAudioV25SampleRateTable = [11025, 12000, 8000, 0];\n\n        this._mpegAudioL1BitRateTable = [0, 32, 64, 96, 128, 160, 192, 224, 256, 288, 320, 352, 384, 416, 448, -1];\n        this._mpegAudioL2BitRateTable = [0, 32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384, -1];\n        this._mpegAudioL3BitRateTable = [0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, -1];\n\n        this._videoTrack = { type: 'video', id: 1, sequenceNumber: 0, samples: [], length: 0 };\n        this._audioTrack = { type: 'audio', id: 2, sequenceNumber: 0, samples: [], length: 0 };\n\n        this._littleEndian = (function () {\n            let buf = new ArrayBuffer(2);\n            (new DataView(buf)).setInt16(0, 256, true);  // little-endian write\n            return (new Int16Array(buf))[0] === 256;  // platform-spec read, if equal then LE\n        })();\n    }\n\n    destroy() {\n        this._mediaInfo = null;\n        this._metadata = null;\n        this._audioMetadata = null;\n        this._videoMetadata = null;\n        this._videoTrack = null;\n        this._audioTrack = null;\n\n        this._onError = null;\n        this._onMediaInfo = null;\n        this._onMetaDataArrived = null;\n        this._onScriptDataArrived = null;\n        this._onTrackMetadata = null;\n        this._onDataAvailable = null;\n        this.onAudioParseDone = null;\n        this.onVideoParseDone = null;\n    }\n\n    static probe(buffer) {\n        let data = new Uint8Array(buffer);\n        let mismatch = { match: false };\n\n        if (data[0] !== 0x46 || data[1] !== 0x4C || data[2] !== 0x56 || data[3] !== 0x01) {\n            return mismatch;\n        }\n\n        let hasAudio = ((data[4] & 4) >>> 2) !== 0;\n        let hasVideo = (data[4] & 1) !== 0;\n\n        let offset = ReadBig32(data, 5);\n\n        if (offset < 9) {\n            return mismatch;\n        }\n\n        return {\n            match: true,\n            consumed: offset,\n            dataOffset: offset,\n            hasAudioTrack: hasAudio,\n            hasVideoTrack: hasVideo\n        };\n    }\n\n    bindDataSource(loader) {\n        // loader.onDataArrival = this.parseChunks.bind(this);\n        return this;\n    }\n\n    // prototype: function(type: string, metadata: any): void\n    get onTrackMetadata() {\n        return this._onTrackMetadata;\n    }\n\n    set onTrackMetadata(callback) {\n        this._onTrackMetadata = callback;\n    }\n\n    // prototype: function(mediaInfo: MediaInfo): void\n    get onMediaInfo() {\n        return this._onMediaInfo;\n    }\n\n    set onMediaInfo(callback) {\n        this._onMediaInfo = callback;\n    }\n\n    get onMetaDataArrived() {\n        return this._onMetaDataArrived;\n    }\n\n    set onMetaDataArrived(callback) {\n        this._onMetaDataArrived = callback;\n    }\n\n    get onScriptDataArrived() {\n        return this._onScriptDataArrived;\n    }\n\n    set onScriptDataArrived(callback) {\n        this._onScriptDataArrived = callback;\n    }\n\n    // prototype: function(type: number, info: string): void\n    get onError() {\n        return this._onError;\n    }\n\n    set onError(callback) {\n        this._onError = callback;\n    }\n\n    // prototype: function(videoTrack: any, audioTrack: any): void\n    get onDataAvailable() {\n        return this._onDataAvailable;\n    }\n\n    set onDataAvailable(callback) {\n        this._onDataAvailable = callback;\n    }\n\n    // timestamp base for output samples, must be in milliseconds\n    get timestampBase() {\n        return this._timestampBase;\n    }\n\n    set timestampBase(base) {\n        this._timestampBase = base;\n    }\n\n    get overridedDuration() {\n        return this._duration;\n    }\n\n    // Force-override media duration. Must be in milliseconds, int32\n    set overridedDuration(duration) {\n        this._durationOverrided = true;\n        this._duration = duration;\n        this._mediaInfo.duration = duration;\n    }\n\n    // Force-override audio track present flag, boolean\n    set overridedHasAudio(hasAudio) {\n        this._hasAudioFlagOverrided = true;\n        this._hasAudio = hasAudio;\n        this._mediaInfo.hasAudio = hasAudio;\n    }\n\n    // Force-override video track present flag, boolean\n    set overridedHasVideo(hasVideo) {\n        this._hasVideoFlagOverrided = true;\n        this._hasVideo = hasVideo;\n        this._mediaInfo.hasVideo = hasVideo;\n    }\n\n    resetMediaInfo() {\n        this._mediaInfo = new MediaInfo();\n    }\n\n    _isInitialMetadataDispatched() {\n        if (this._hasAudio && this._hasVideo) {  // both audio & video\n            return this._audioInitialMetadataDispatched && this._videoInitialMetadataDispatched;\n        }\n        if (this._hasAudio && !this._hasVideo) {  // audio only\n            return this._audioInitialMetadataDispatched;\n        }\n        if (!this._hasAudio && this._hasVideo) {  // video only\n            return this._videoInitialMetadataDispatched;\n        }\n        return false;\n    }\n\n    // function parseChunks(chunk: ArrayBuffer, byteStart: number): number;\n    parseChunks(chunk, byteStart) {\n        // if (!this._onError || !this._onMediaInfo || !this._onTrackMetadata || !this._onDataAvailable) {\n        //     throw new IllegalStateException('Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified');\n        // }\n        let offset = 0;\n        let le = this._littleEndian;\n\n        if (byteStart === 0) {  // buffer with FLV header\n            if (chunk.byteLength > 13) {\n                let probeData = FLVDemuxer.probe(chunk);\n                offset = probeData.dataOffset;\n            } else {\n                return 0;\n            }\n        }\n\n        if (this._firstParse) {  // handle PreviousTagSize0 before Tag1\n            this._firstParse = false;\n            if (byteStart + offset !== this._dataOffset) {\n                Log.w(this.TAG, 'First time parsing but chunk byteStart invalid!');\n            }\n\n            let v = new DataView(chunk, offset);\n            let prevTagSize0 = v.getUint32(0, !le);\n            if (prevTagSize0 !== 0) {\n                Log.w(this.TAG, 'PrevTagSize0 !== 0 !!!');\n            }\n            offset += 4;\n        }\n        while (offset < chunk.byteLength) {\n            this._dispatch = true;\n\n            let v = new DataView(chunk, offset);\n\n            if (offset + 11 + 4 > chunk.byteLength) {\n                // data not enough for parsing an flv tag\n                break;\n            }\n\n            let tagType = v.getUint8(0);\n            let dataSize = v.getUint32(0, !le) & 0x00FFFFFF;\n\n            if (offset + 11 + dataSize + 4 > chunk.byteLength) {\n                // data not enough for parsing actual data body\n                break;\n            }\n\n            if (tagType !== 8 && tagType !== 9 && tagType !== 18) {\n                Log.w(this.TAG, `Unsupported tag type ${tagType}, skipped`);\n                // consume the whole tag (skip it)\n                offset += 11 + dataSize + 4;\n                continue;\n            }\n\n            let ts2 = v.getUint8(4);\n            let ts1 = v.getUint8(5);\n            let ts0 = v.getUint8(6);\n            let ts3 = v.getUint8(7);\n\n            let timestamp = ts0 | (ts1 << 8) | (ts2 << 16) | (ts3 << 24);\n\n            let streamId = v.getUint32(7, !le) & 0x00FFFFFF;\n            if (streamId !== 0) {\n                Log.w(this.TAG, 'Meet tag which has StreamID != 0!');\n            }\n\n            let dataOffset = offset + 11;\n\n            switch (tagType) {\n                case 8:  // Audio\n                    this._parseAudioData(chunk, dataOffset, dataSize, timestamp);\n                    break;\n                case 9:  // Video\n                    this._parseVideoData(chunk, dataOffset, dataSize, timestamp, byteStart + offset);\n                    break;\n                case 18:  // ScriptDataObject\n                    this._parseScriptData(chunk, dataOffset, dataSize);\n                    break;\n            }\n\n            let prevTagSize = v.getUint32(11 + dataSize, !le);\n            if (prevTagSize !== 11 + dataSize) {\n                Log.w(this.TAG, `Invalid PrevTagSize ${prevTagSize}`);\n            }\n\n            offset += 11 + dataSize + 4;  // tagBody + dataSize + prevTagSize\n        }\n\n        // dispatch parsed frames to consumer (typically, the remuxer)\n        // if (this._isInitialMetadataDispatched()) {\n        //     if (this._dispatch && (this._audioTrack.length || this._videoTrack.length)) {\n        //         this._onDataAvailable(this._audioTrack, this._videoTrack);\n        //     }\n        // }\n\n        return offset;  // consumed bytes, just equals latest offset index\n    }\n\n    _parseScriptData(arrayBuffer, dataOffset, dataSize) {\n        let scriptData = AMF.parseScriptData(arrayBuffer, dataOffset, dataSize);\n\n        if (scriptData.hasOwnProperty('onMetaData')) {\n            if (scriptData.onMetaData == null || typeof scriptData.onMetaData !== 'object') {\n                Log.w(this.TAG, 'Invalid onMetaData structure!');\n                return;\n            }\n            if (this._metadata) {\n                Log.w(this.TAG, 'Found another onMetaData tag!');\n            }\n            this._metadata = scriptData;\n            let onMetaData = this._metadata.onMetaData;\n\n            if (this._onMetaDataArrived) {\n                this._onMetaDataArrived(Object.assign({}, onMetaData));\n            }\n\n            if (typeof onMetaData.hasAudio === 'boolean') {  // hasAudio\n                if (this._hasAudioFlagOverrided === false) {\n                    this._hasAudio = onMetaData.hasAudio;\n                    this._mediaInfo.hasAudio = this._hasAudio;\n                }\n            }\n            if (typeof onMetaData.hasVideo === 'boolean') {  // hasVideo\n                if (this._hasVideoFlagOverrided === false) {\n                    this._hasVideo = onMetaData.hasVideo;\n                    this._mediaInfo.hasVideo = this._hasVideo;\n                }\n            }\n            if (typeof onMetaData.audiodatarate === 'number') {  // audiodatarate\n                this._mediaInfo.audioDataRate = onMetaData.audiodatarate;\n            }\n            if (typeof onMetaData.videodatarate === 'number') {  // videodatarate\n                this._mediaInfo.videoDataRate = onMetaData.videodatarate;\n            }\n            if (typeof onMetaData.width === 'number') {  // width\n                this._mediaInfo.width = onMetaData.width;\n            }\n            if (typeof onMetaData.height === 'number') {  // height\n                this._mediaInfo.height = onMetaData.height;\n            }\n            if (typeof onMetaData.duration === 'number') {  // duration\n                if (!this._durationOverrided) {\n                    let duration = Math.floor(onMetaData.duration * this._timescale);\n                    this._duration = duration;\n                    this._mediaInfo.duration = duration;\n                }\n            } else {\n                this._mediaInfo.duration = 0;\n            }\n            if (typeof onMetaData.framerate === 'number') {  // framerate\n                let fps_num = Math.floor(onMetaData.framerate * 1000);\n                if (fps_num > 0) {\n                    let fps = fps_num / 1000;\n                    this._referenceFrameRate.fixed = true;\n                    this._referenceFrameRate.fps = fps;\n                    this._referenceFrameRate.fps_num = fps_num;\n                    this._referenceFrameRate.fps_den = 1000;\n                    this._mediaInfo.fps = fps;\n                }\n            }\n            if (typeof onMetaData.keyframes === 'object') {  // keyframes\n                this._mediaInfo.hasKeyframesIndex = true;\n                let keyframes = onMetaData.keyframes;\n                this._mediaInfo.keyframesIndex = this._parseKeyframesIndex(keyframes);\n                onMetaData.keyframes = null;  // keyframes has been extracted, remove it\n            } else {\n                this._mediaInfo.hasKeyframesIndex = false;\n            }\n            this._dispatch = false;\n            this._mediaInfo.metadata = onMetaData;\n            Log.v(this.TAG, 'Parsed onMetaData');\n            if (this._mediaInfo.isComplete()) {\n                this._onMediaInfo(this._mediaInfo);\n            }\n        }\n\n        if (Object.keys(scriptData).length > 0) {\n            if (this._onScriptDataArrived) {\n                this._onScriptDataArrived(Object.assign({}, scriptData));\n            }\n        }\n    }\n\n    _parseKeyframesIndex(keyframes) {\n        let times = [];\n        let filepositions = [];\n\n        // ignore first keyframe which is actually AVC Sequence Header (AVCDecoderConfigurationRecord)\n        for (let i = 1; i < keyframes.times.length; i++) {\n            let time = this._timestampBase + Math.floor(keyframes.times[i] * 1000);\n            times.push(time);\n            filepositions.push(keyframes.filepositions[i]);\n        }\n\n        return {\n            times: times,\n            filepositions: filepositions\n        };\n    }\n\n    _parseAudioData(arrayBuffer, dataOffset, dataSize, tagTimestamp) {\n        if (dataSize <= 1) {\n            Log.w(this.TAG, 'Flv: Invalid audio packet, missing SoundData payload!');\n            return;\n        }\n\n        if (this._hasAudioFlagOverrided === true && this._hasAudio === false) {\n            // If hasAudio: false indicated explicitly in MediaDataSource,\n            // Ignore all the audio packets\n            return;\n        }\n\n        let le = this._littleEndian;\n        let v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n        let soundSpec = v.getUint8(0);\n\n        let soundFormat = soundSpec >>> 4;\n        if (soundFormat !== 2 && soundFormat !== 10) {  // MP3 or AAC\n            this._onError(DemuxErrors.CODEC_UNSUPPORTED, 'Flv: Unsupported audio codec idx: ' + soundFormat);\n            return;\n        }\n\n        let soundRate = 0;\n        let soundRateIndex = (soundSpec & 12) >>> 2;\n        if (soundRateIndex >= 0 && soundRateIndex <= 4) {\n            soundRate = this._flvSoundRateTable[soundRateIndex];\n        } else {\n            this._onError(DemuxErrors.FORMAT_ERROR, 'Flv: Invalid audio sample rate idx: ' + soundRateIndex);\n            return;\n        }\n\n        let soundSize = (soundSpec & 2) >>> 1;  // unused\n        let soundType = (soundSpec & 1);\n\n\n        let meta = this._audioMetadata;\n        let track = this._audioTrack;\n\n        if (!meta) {\n            if (this._hasAudio === false && this._hasAudioFlagOverrided === false) {\n                this._hasAudio = true;\n                this._mediaInfo.hasAudio = true;\n            }\n\n            // initial metadata\n            meta = this._audioMetadata = {};\n            meta.type = 'audio';\n            meta.id = track.id;\n            meta.timescale = this._timescale;\n            meta.duration = this._duration;\n            meta.audioSampleRate = soundRate;\n            meta.channelCount = (soundType === 0 ? 1 : 2);\n        }\n\n        if (soundFormat === 10) {  // AAC\n            let aacData = this._parseAACAudioData(arrayBuffer, dataOffset + 1, dataSize - 1);\n            if (aacData == undefined) {\n                return;\n            }\n\n            if (aacData.packetType === 0) {  // AAC sequence header (AudioSpecificConfig)\n                if (meta.config) {\n                    Log.w(this.TAG, 'Found another AudioSpecificConfig!');\n                }\n                let misc = aacData.data;\n                meta.audioSampleRate = misc.samplingRate;\n                meta.channelCount = misc.channelCount;\n                meta.codec = misc.codec;\n                meta.originalCodec = misc.originalCodec;\n                meta.config = misc.config;\n                // added by qli5\n                meta.configRaw = misc.configRaw;\n                // added by Xmader\n                meta.audioObjectType = misc.audioObjectType;\n                meta.samplingFrequencyIndex = misc.samplingIndex;\n                meta.channelConfig = misc.channelCount;\n                // The decode result of an aac sample is 1024 PCM samples\n                meta.refSampleDuration = 1024 / meta.audioSampleRate * meta.timescale;\n                Log.v(this.TAG, 'Parsed AudioSpecificConfig');\n                if (this._isInitialMetadataDispatched()) {\n                    // Non-initial metadata, force dispatch (or flush) parsed frames to remuxer\n                    if (this._dispatch && (this._audioTrack.length || this._videoTrack.length)) {\n                        this._onDataAvailable(this._audioTrack, this._videoTrack);\n                    }\n                } else {\n                    this._audioInitialMetadataDispatched = true;\n                }\n                // then notify new metadata\n                this._dispatch = false;\n                this.HEADER = {\n                    audioObjectType: meta.audioObjectType,\n                    samplingFrequencyIndex: meta.samplingFrequencyIndex,\n                    channelConfig: meta.channelConfig,\n                    // adtsLen: sample.length + 7\n                };\n                // this._onTrackMetadata('audio', meta);\n\n                let mi = this._mediaInfo;\n                mi.audioCodec = meta.originalCodec;\n                mi.audioSampleRate = meta.audioSampleRate;\n                mi.audioChannelCount = meta.channelCount;\n                if (mi.hasVideo) {\n                    if (mi.videoCodec != null) {\n                        mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + ',' + mi.audioCodec + '\"';\n                    }\n                } else {\n                    mi.mimeType = 'video/x-flv; codecs=\"' + mi.audioCodec + '\"';\n                }\n                if (mi.isComplete()) {\n                    // this._onMediaInfo(mi);\n                }\n            } else if (aacData.packetType === 1) {  // AAC raw frame data\n\n                const getAdtsHeaders = (init) => {\n                    const { audioObjectType, samplingFrequencyIndex, channelConfig, adtsLen } = init;\n                    const headers = new Uint8Array(7);\n\n                    headers[0] = 0xff;         // syncword:0xfff                           高8bits\n                    headers[1] = 0xf0;         // syncword:0xfff                           低4bits\n                    headers[1] |= (0 << 3);    // MPEG Version:0 for MPEG-4,1 for MPEG-2   1bit\n                    headers[1] |= (0 << 1);    // Layer:0                                  2bits \n                    headers[1] |= 1;           // protection absent:1                      1bit\n                    headers[2] = (audioObjectType - 1) << 6;            // profile:audio_object_type - 1                      2bits\n                    headers[2] |= (samplingFrequencyIndex & 0x0f) << 2; // sampling frequency index:sampling_frequency_index  4bits \n                    headers[2] |= (0 << 1);                             // private bit:0                                      1bit\n                    headers[2] |= (channelConfig & 0x04) >> 2;          // channel configuration:channel_config               高1bit\n\n                    headers[3] = (channelConfig & 0x03) << 6;    // channel configuration：channel_config     低2bits\n                    headers[3] |= (0 << 5);                      // original：0                               1bit\n                    headers[3] |= (0 << 4);                      // home：0                                   1bit\n                    headers[3] |= (0 << 3);                      // copyright id bit：0                       1bit  \n                    headers[3] |= (0 << 2);                      // copyright id start：0                     1bit\n\n                    headers[3] |= (adtsLen & 0x1800) >> 11;      // frame length：value    高2bits\n                    headers[4] = (adtsLen & 0x7f8) >> 3;         // frame length：value    中间8bits \n                    headers[5] = (adtsLen & 0x7) << 5;           // frame length：value    低3bits\n                    headers[5] |= 0x1f;                          // buffer fullness：0x7ff 高5bits \n                    headers[6] = 0xfc;\n\n                    return headers;\n                };\n\n\n                let dts = this._timestampBase + tagTimestamp;\n                let aacSample = { unit: aacData.data, length: aacData.data.byteLength, dts: dts, pts: dts };\n\n                let _this = this;\n                let headers = getAdtsHeaders({\n                    audioObjectType: _this.HEADER.audioObjectType,\n                    samplingFrequencyIndex: _this.HEADER.samplingFrequencyIndex,\n                    channelConfig: _this.HEADER.channelConfig,\n                    adtsLen: aacSample.length + 7\n                });\n                let final = [];\n                final.push.apply(final, _toConsumableArray(headers).concat(_toConsumableArray(aacSample.unit)));\n\n                // console.log('音频的结果', final);\n                this.onAudioParseDone(final);\n            } else {\n                Log.e(this.TAG, `Flv: Unsupported AAC data type ${aacData.packetType}`);\n            }\n        } else if (soundFormat === 2) {  // MP3\n            if (!meta.codec) {\n                // We need metadata for mp3 audio track, extract info from frame header\n                let misc = this._parseMP3AudioData(arrayBuffer, dataOffset + 1, dataSize - 1, true);\n                if (misc == undefined) {\n                    return;\n                }\n                meta.audioSampleRate = misc.samplingRate;\n                meta.channelCount = misc.channelCount;\n                meta.codec = misc.codec;\n                meta.originalCodec = misc.originalCodec;\n                // The decode result of an mp3 sample is 1152 PCM samples\n                meta.refSampleDuration = 1152 / meta.audioSampleRate * meta.timescale;\n                Log.v(this.TAG, 'Parsed MPEG Audio Frame Header');\n\n                this._audioInitialMetadataDispatched = true;\n                // this._onTrackMetadata('audio', meta);\n\n                let mi = this._mediaInfo;\n                mi.audioCodec = meta.codec;\n                mi.audioSampleRate = meta.audioSampleRate;\n                mi.audioChannelCount = meta.channelCount;\n                mi.audioDataRate = misc.bitRate;\n                if (mi.hasVideo) {\n                    if (mi.videoCodec != null) {\n                        mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + ',' + mi.audioCodec + '\"';\n                    }\n                } else {\n                    mi.mimeType = 'video/x-flv; codecs=\"' + mi.audioCodec + '\"';\n                }\n                if (mi.isComplete()) {\n                    this._onMediaInfo(mi);\n                }\n            }\n\n            // This packet is always a valid audio packet, extract it\n            let data = this._parseMP3AudioData(arrayBuffer, dataOffset + 1, dataSize - 1, false);\n            if (data == undefined) {\n                return;\n            }\n            let dts = this._timestampBase + tagTimestamp;\n            let mp3Sample = { unit: data, length: data.byteLength, dts: dts, pts: dts };\n            track.samples.push(mp3Sample);\n            track.length += data.length;\n        }\n    }\n\n    _parseAACAudioData(arrayBuffer, dataOffset, dataSize) {\n        if (dataSize <= 1) {\n            Log.w(this.TAG, 'Flv: Invalid AAC packet, missing AACPacketType or/and Data!');\n            return;\n        }\n\n        let result = {};\n        let array = new Uint8Array(arrayBuffer, dataOffset, dataSize);\n\n        result.packetType = array[0];\n\n        if (array[0] === 0) {\n            let getAdtsHeaders = function getAdtsHeaders(init) {\n                let audioObjectType = init.audioObjectType,\n                    samplingFrequencyIndex = init.samplingFrequencyIndex,\n                    channelConfig = init.channelConfig,\n                    adtsLen = init.adtsLen;\n\n                let headers = new Uint8Array(7);\n\n                headers[0] = 0xff; // syncword:0xfff                           高8bits\n                headers[1] = 0xf0; // syncword:0xfff                           低4bits\n                headers[1] |= 0 << 3; // MPEG Version:0 for MPEG-4,1 for MPEG-2   1bit\n                headers[1] |= 0 << 1; // Layer:0                                  2bits \n                headers[1] |= 1; // protection absent:1                      1bit\n\n                headers[2] = audioObjectType - 1 << 6; // profile:audio_object_type - 1                      2bits\n                headers[2] |= (samplingFrequencyIndex & 0x0f) << 2; // sampling frequency index:sampling_frequency_index  4bits \n                headers[2] |= 0 << 1; // private bit:0                                      1bit\n                headers[2] |= (channelConfig & 0x04) >> 2; // channel configuration:channel_config               高1bit\n\n                headers[3] = (channelConfig & 0x03) << 6; // channel configuration：channel_config     低2bits\n                headers[3] |= 0 << 5; // original：0                               1bit\n                headers[3] |= 0 << 4; // home：0                                   1bit\n                headers[3] |= 0 << 3; // copyright id bit：0                       1bit  \n                headers[3] |= 0 << 2; // copyright id start：0                     1bit\n\n                headers[3] |= (adtsLen & 0x1800) >> 11; // frame length：value    高2bits\n                headers[4] = (adtsLen & 0x7f8) >> 3; // frame length：value    中间8bits \n                headers[5] = (adtsLen & 0x7) << 5; // frame length：value    低3bits\n                headers[5] |= 0x1f; // buffer fullness：0x7ff 高5bits \n                headers[6] = 0xfc;\n\n                return headers;\n            };\n            result.data = this._parseAACAudioSpecificConfig(arrayBuffer, dataOffset + 1, dataSize - 1);\n        } else {\n            result.data = array.subarray(1);\n        }\n\n        return result;\n    }\n\n    _parseAACAudioSpecificConfig(arrayBuffer, dataOffset, dataSize) {\n        let array = new Uint8Array(arrayBuffer, dataOffset, dataSize);\n        let config = null;\n\n        /* Audio Object Type:\n           0: Null\n           1: AAC Main\n           2: AAC LC\n           3: AAC SSR (Scalable Sample Rate)\n           4: AAC LTP (Long Term Prediction)\n           5: HE-AAC / SBR (Spectral Band Replication)\n           6: AAC Scalable\n        */\n\n        let audioObjectType = 0;\n        let originalAudioObjectType = 0;\n        let audioExtensionObjectType = null;\n        let samplingIndex = 0;\n        let extensionSamplingIndex = null;\n\n        // 5 bits\n        audioObjectType = originalAudioObjectType = array[0] >>> 3;\n        // 4 bits\n        samplingIndex = ((array[0] & 0x07) << 1) | (array[1] >>> 7);\n        if (samplingIndex < 0 || samplingIndex >= this._mpegSamplingRates.length) {\n            this._onError(DemuxErrors.FORMAT_ERROR, 'Flv: AAC invalid sampling frequency index!');\n            return;\n        }\n\n        let samplingFrequence = this._mpegSamplingRates[samplingIndex];\n\n        // 4 bits\n        let channelConfig = (array[1] & 0x78) >>> 3;\n        if (channelConfig < 0 || channelConfig >= 8) {\n            this._onError(DemuxErrors.FORMAT_ERROR, 'Flv: AAC invalid channel configuration');\n            return;\n        }\n\n        if (audioObjectType === 5) {  // HE-AAC?\n            // 4 bits\n            extensionSamplingIndex = ((array[1] & 0x07) << 1) | (array[2] >>> 7);\n            // 5 bits\n            audioExtensionObjectType = (array[2] & 0x7C) >>> 2;\n        }\n\n        // workarounds for various browsers\n        let userAgent = self.navigator.userAgent.toLowerCase();\n\n        if (userAgent.indexOf('firefox') !== -1) {\n            // firefox: use SBR (HE-AAC) if freq less than 24kHz\n            if (samplingIndex >= 6) {\n                audioObjectType = 5;\n                config = new Array(4);\n                extensionSamplingIndex = samplingIndex - 3;\n            } else {  // use LC-AAC\n                audioObjectType = 2;\n                config = new Array(2);\n                extensionSamplingIndex = samplingIndex;\n            }\n        } else if (userAgent.indexOf('android') !== -1) {\n            // android: always use LC-AAC\n            audioObjectType = 2;\n            config = new Array(2);\n            extensionSamplingIndex = samplingIndex;\n        } else {\n            // for other browsers, e.g. chrome...\n            // Always use HE-AAC to make it easier to switch aac codec profile\n            audioObjectType = 5;\n            extensionSamplingIndex = samplingIndex;\n            config = new Array(4);\n\n            if (samplingIndex >= 6) {\n                extensionSamplingIndex = samplingIndex - 3;\n            } else if (channelConfig === 1) {  // Mono channel\n                audioObjectType = 2;\n                config = new Array(2);\n                extensionSamplingIndex = samplingIndex;\n            }\n        }\n\n        config[0] = audioObjectType << 3;\n        config[0] |= (samplingIndex & 0x0F) >>> 1;\n        config[1] = (samplingIndex & 0x0F) << 7;\n        config[1] |= (channelConfig & 0x0F) << 3;\n        if (audioObjectType === 5) {\n            config[1] |= ((extensionSamplingIndex & 0x0F) >>> 1);\n            config[2] = (extensionSamplingIndex & 0x01) << 7;\n            // extended audio object type: force to 2 (LC-AAC)\n            config[2] |= (2 << 2);\n            config[3] = 0;\n        }\n\n        return {\n            audioObjectType: audioObjectType, // audio_object_type,        added by Xmader\n            samplingIndex: samplingIndex, // sampling_frequency_index, added by Xmader\n            configRaw: array, // \n            config: config,\n            samplingRate: samplingFrequence,\n            channelCount: channelConfig,\n            codec: 'mp4a.40.' + audioObjectType,\n            originalCodec: 'mp4a.40.' + originalAudioObjectType\n        };\n    }\n\n    _parseMP3AudioData(arrayBuffer, dataOffset, dataSize, requestHeader) {\n        if (dataSize < 4) {\n            Log.w(this.TAG, 'Flv: Invalid MP3 packet, header missing!');\n            return;\n        }\n\n        let le = this._littleEndian;\n        let array = new Uint8Array(arrayBuffer, dataOffset, dataSize);\n        let result = null;\n\n        if (requestHeader) {\n            if (array[0] !== 0xFF) {\n                return;\n            }\n            let ver = (array[1] >>> 3) & 0x03;\n            let layer = (array[1] & 0x06) >> 1;\n\n            let bitrate_index = (array[2] & 0xF0) >>> 4;\n            let sampling_freq_index = (array[2] & 0x0C) >>> 2;\n\n            let channel_mode = (array[3] >>> 6) & 0x03;\n            let channel_count = channel_mode !== 3 ? 2 : 1;\n\n            let sample_rate = 0;\n            let bit_rate = 0;\n            let object_type = 34;  // Layer-3, listed in MPEG-4 Audio Object Types\n\n            let codec = 'mp3';\n\n            switch (ver) {\n                case 0:  // MPEG 2.5\n                    sample_rate = this._mpegAudioV25SampleRateTable[sampling_freq_index];\n                    break;\n                case 2:  // MPEG 2\n                    sample_rate = this._mpegAudioV20SampleRateTable[sampling_freq_index];\n                    break;\n                case 3:  // MPEG 1\n                    sample_rate = this._mpegAudioV10SampleRateTable[sampling_freq_index];\n                    break;\n            }\n\n            switch (layer) {\n                case 1:  // Layer 3\n                    object_type = 34;\n                    if (bitrate_index < this._mpegAudioL3BitRateTable.length) {\n                        bit_rate = this._mpegAudioL3BitRateTable[bitrate_index];\n                    }\n                    break;\n                case 2:  // Layer 2\n                    object_type = 33;\n                    if (bitrate_index < this._mpegAudioL2BitRateTable.length) {\n                        bit_rate = this._mpegAudioL2BitRateTable[bitrate_index];\n                    }\n                    break;\n                case 3:  // Layer 1\n                    object_type = 32;\n                    if (bitrate_index < this._mpegAudioL1BitRateTable.length) {\n                        bit_rate = this._mpegAudioL1BitRateTable[bitrate_index];\n                    }\n                    break;\n            }\n\n            result = {\n                bitRate: bit_rate,\n                samplingRate: sample_rate,\n                channelCount: channel_count,\n                codec: codec,\n                originalCodec: codec\n            };\n        } else {\n            result = array;\n        }\n\n        return result;\n    }\n\n    _parseVideoData(arrayBuffer, dataOffset, dataSize, tagTimestamp, tagPosition) {\n        if (dataSize <= 1) {\n            Log.w(this.TAG, 'Flv: Invalid video packet, missing VideoData payload!');\n            return;\n        }\n\n        if (this._hasVideoFlagOverrided === true && this._hasVideo === false) {\n            // If hasVideo: false indicated explicitly in MediaDataSource,\n            // Ignore all the video packets\n            return;\n        }\n\n        let spec = (new Uint8Array(arrayBuffer, dataOffset, dataSize))[0];\n\n        let frameType = (spec & 240) >>> 4;\n        let codecId = spec & 15;\n\n        if (codecId !== 7) {\n            this._onError(DemuxErrors.CODEC_UNSUPPORTED, `Flv: Unsupported codec in video frame: ${codecId}`);\n            return;\n        }\n\n        this._parseAVCVideoPacket(arrayBuffer, dataOffset + 1, dataSize - 1, tagTimestamp, tagPosition, frameType);\n    }\n\n    _parseAVCVideoPacket(arrayBuffer, dataOffset, dataSize, tagTimestamp, tagPosition, frameType) {\n        if (dataSize < 4) {\n            Log.w(this.TAG, 'Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime');\n            return;\n        }\n        let le = this._littleEndian;\n        let v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n        let packetType = v.getUint8(0);\n        let cts_unsigned = v.getUint32(0, !le) & 0x00FFFFFF;\n        let cts = (cts_unsigned << 8) >> 8;  // convert to 24-bit signed int\n\n        if (packetType === 0) {  // AVCDecoderConfigurationRecord\n            this._parseAVCDecoderConfigurationRecord(arrayBuffer, dataOffset + 4, dataSize - 4);\n        } else if (packetType === 1) {  // One or more Nalus\n            this._parseAVCVideoData(arrayBuffer, dataOffset + 4, dataSize - 4, tagTimestamp, tagPosition, frameType, cts);\n        } else if (packetType === 2) {\n            // empty, AVC end of sequence\n        } else {\n            this._onError(DemuxErrors.FORMAT_ERROR, `Flv: Invalid video packet type ${packetType}`);\n            return;\n        }\n    }\n\n    _parseAVCDecoderConfigurationRecord(arrayBuffer, dataOffset, dataSize) {\n        if (dataSize < 7) {\n            Log.w(this.TAG, 'Flv: Invalid AVCDecoderConfigurationRecord, lack of data!');\n            return;\n        }\n        let meta = this._videoMetadata;\n        let track = this._videoTrack;\n        let le = this._littleEndian;\n        let v = new DataView(arrayBuffer, dataOffset, dataSize);\n        if (!meta) {\n            if (this._hasVideo === false && this._hasVideoFlagOverrided === false) {\n                this._hasVideo = true;\n                this._mediaInfo.hasVideo = true;\n            }\n\n            meta = this._videoMetadata = {};\n            meta.type = 'video';\n            meta.id = track.id;\n            meta.timescale = this._timescale;\n            meta.duration = this._duration;\n        } else {\n            if (typeof meta.avcc !== 'undefined') {\n                Log.w(this.TAG, 'Found another AVCDecoderConfigurationRecord!');\n            }\n        }\n\n        let version = v.getUint8(0);  // configurationVersion\n        let avcProfile = v.getUint8(1);  // avcProfileIndication\n        let profileCompatibility = v.getUint8(2);  // profile_compatibility\n        let avcLevel = v.getUint8(3);  // AVCLevelIndication\n\n        if (version !== 1 || avcProfile === 0) {\n            this._onError(DemuxErrors.FORMAT_ERROR, 'Flv: Invalid AVCDecoderConfigurationRecord');\n            return;\n        }\n\n        this._naluLengthSize = (v.getUint8(4) & 3) + 1;  // lengthSizeMinusOne\n        if (this._naluLengthSize !== 3 && this._naluLengthSize !== 4) {  // holy shit!!!\n            this._onError(DemuxErrors.FORMAT_ERROR, `Flv: Strange NaluLengthSizeMinusOne: ${this._naluLengthSize - 1}`);\n            return;\n        }\n\n        let spsCount = v.getUint8(5) & 31;  // numOfSequenceParameterSets\n        if (spsCount === 0) {\n            this._onError(DemuxErrors.FORMAT_ERROR, 'Flv: Invalid AVCDecoderConfigurationRecord: No SPS');\n            return;\n        } else if (spsCount > 1) {\n            Log.w(this.TAG, `Flv: Strange AVCDecoderConfigurationRecord: SPS Count = ${spsCount}`);\n        }\n\n        let offset = 6;\n\n        for (let i = 0; i < spsCount; i++) {\n            let len = v.getUint16(offset, !le);  // sequenceParameterSetLength\n            offset += 2;\n\n            if (len === 0) {\n                continue;\n            }\n\n            // Notice: Nalu without startcode header (00 00 00 01)\n            let sps = new Uint8Array(arrayBuffer, dataOffset + offset, len);\n            offset += len;\n            let finalsps = new Uint8Array(len + 4);\n            finalsps.set([0, 0, 0, 1], 0);\n            finalsps.set(sps, 4);\n\n            let config = SPSParser.parseSPS(sps);\n            if (i !== 0) {\n                // ignore other sps's config\n                continue;\n            }\n\n            this.onVideoParseDone(finalsps);\n\n            meta.codecWidth = config.codec_size.width;\n            meta.codecHeight = config.codec_size.height;\n            meta.presentWidth = config.present_size.width;\n            meta.presentHeight = config.present_size.height;\n\n            meta.profile = config.profile_string;\n            meta.level = config.level_string;\n            meta.bitDepth = config.bit_depth;\n            meta.chromaFormat = config.chroma_format;\n            meta.sarRatio = config.sar_ratio;\n            meta.frameRate = config.frame_rate;\n\n            if (config.frame_rate.fixed === false ||\n                config.frame_rate.fps_num === 0 ||\n                config.frame_rate.fps_den === 0) {\n                meta.frameRate = this._referenceFrameRate;\n            }\n\n            let fps_den = meta.frameRate.fps_den;\n            let fps_num = meta.frameRate.fps_num;\n            meta.refSampleDuration = meta.timescale * (fps_den / fps_num);\n\n            let codecArray = sps.subarray(1, 4);\n            let codecString = 'avc1.';\n            for (let j = 0; j < 3; j++) {\n                let h = codecArray[j].toString(16);\n                if (h.length < 2) {\n                    h = '0' + h;\n                }\n                codecString += h;\n            }\n            meta.codec = codecString;\n\n            let mi = this._mediaInfo;\n            mi.width = meta.codecWidth;\n            mi.height = meta.codecHeight;\n            mi.fps = meta.frameRate.fps;\n            mi.profile = meta.profile;\n            mi.level = meta.level;\n            mi.refFrames = config.ref_frames;\n            mi.chromaFormat = config.chroma_format_string;\n            mi.sarNum = meta.sarRatio.width;\n            mi.sarDen = meta.sarRatio.height;\n            mi.videoCodec = codecString;\n\n            if (mi.hasAudio) {\n                if (mi.audioCodec != null) {\n                    mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + ',' + mi.audioCodec + '\"';\n                }\n            } else {\n                mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + '\"';\n            }\n            // if (mi.isComplete()) {\n            // this._onMediaInfo(mi);\n            // }\n        }\n\n        let ppsCount = v.getUint8(offset);  // numOfPictureParameterSets\n        if (ppsCount === 0) {\n            this._onError(DemuxErrors.FORMAT_ERROR, 'Flv: Invalid AVCDecoderConfigurationRecord: No PPS');\n            return;\n        } else if (ppsCount > 1) {\n            Log.w(this.TAG, `Flv: Strange AVCDecoderConfigurationRecord: PPS Count = ${ppsCount}`);\n        }\n\n        offset++;\n\n        for (let i = 0; i < ppsCount; i++) {\n            let len = v.getUint16(offset, !le);  // pictureParameterSetLength\n            offset += 2;\n\n            if (len === 0) {\n                continue;\n            }\n\n            let pps = new Uint8Array(arrayBuffer, dataOffset + offset, len);\n            let finalpps = new Uint8Array(len + 4);\n            finalpps.set([0, 0, 0, 1], 0);\n            finalpps.set(pps, 4);\n            this.onVideoParseDone(finalpps);\n\n            // pps is useless for extracting video information\n            offset += len;\n        }\n\n        meta.avcc = new Uint8Array(dataSize);\n        meta.avcc.set(new Uint8Array(arrayBuffer, dataOffset, dataSize), 0);\n        Log.v(this.TAG, 'Parsed AVCDecoderConfigurationRecord');\n        if (this._isInitialMetadataDispatched()) {\n            // flush parsed frames\n            if (this._dispatch && (this._audioTrack.length || this._videoTrack.length)) {\n                this._onDataAvailable(this._audioTrack, this._videoTrack);\n            }\n        } else {\n            this._videoInitialMetadataDispatched = true;\n        }\n        // notify new metadata\n        this._dispatch = false;\n        // this._onTrackMetadata('video', meta);\n    }\n\n    _parseAVCVideoData(arrayBuffer, dataOffset, dataSize, tagTimestamp, tagPosition, frameType, cts) {\n        let le = this._littleEndian;\n        let v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n        let units = [], length = 0;\n\n        let offset = 0;\n        const lengthSize = this._naluLengthSize;\n        let dts = this._timestampBase + tagTimestamp;\n        let keyframe = (frameType === 1);  // from FLV Frame Type constants\n\n        while (offset < dataSize) {\n            if (offset + 4 >= dataSize) {\n                Log.w(this.TAG, `Malformed Nalu near timestamp ${dts}, offset = ${offset}, dataSize = ${dataSize}`);\n                break;  // data not enough for next Nalu\n            }\n            // Nalu with length-header (AVC1)\n            let naluSize = v.getUint32(offset, !le);  // Big-Endian read\n            if (lengthSize === 3) {\n                naluSize >>>= 8;\n            }\n            if (naluSize > dataSize - lengthSize) {\n                Log.w(this.TAG, `Malformed Nalus near timestamp ${dts}, NaluSize > DataSize!`);\n                return;\n            }\n\n            let unitType = v.getUint8(offset + lengthSize) & 0x1F;\n\n            if (unitType === 5) {  // IDR\n                keyframe = true;\n            }\n\n            // 最终输出数据 finalData\n            let data = new Uint8Array(arrayBuffer, dataOffset + offset, lengthSize + naluSize);\n            let finalData = new Uint8Array(arrayBuffer, dataOffset + offset, lengthSize + naluSize);\n            finalData[0] = 0;\n            finalData[1] = 0;\n            finalData[2] = 0;\n            finalData[3] = 1;\n\n            this.onVideoParseDone(finalData);\n            let unit = { type: unitType, data: data };\n            units.push(unit);\n            length += data.byteLength;\n\n            offset += lengthSize + naluSize;\n            // this.saveDts(dts + cts);\n\n\n        }\n\n        if (units.length) {\n            let track = this._videoTrack;\n            let avcSample = {\n                units: units,\n                length: length,\n                isKeyframe: keyframe,\n                dts: dts,\n                cts: cts,\n                pts: (dts + cts)\n            };\n            if (keyframe) {\n                avcSample.fileposition = tagPosition;\n            }\n            // console.log('avcSample', avcSample)\n            // track.samples.push(avcSample);\n            // track.length += length;\n            // console.log(avcSample.units)\n            // console.log(avcSample.dts)\n            if (avcSample.dts == 0) {\n                // console.log(avcSample)\n            }\n            this.saveDts(avcSample.dts);\n        }\n    }\n\n}\n\nexport default FLVDemuxer;","/*\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\n *\n * @author zheng qian <xqq@xqq.im>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ExpGolomb from './exp-golomb.js';\n\nclass SPSParser {\n\n    static _ebsp2rbsp(uint8array) {\n        let src = uint8array;\n        let src_length = src.byteLength;\n        let dst = new Uint8Array(src_length);\n        let dst_idx = 0;\n\n        for (let i = 0; i < src_length; i++) {\n            if (i >= 2) {\n                // Unescape: Skip 0x03 after 00 00\n                if (src[i] === 0x03 && src[i - 1] === 0x00 && src[i - 2] === 0x00) {\n                    continue;\n                }\n            }\n            dst[dst_idx] = src[i];\n            dst_idx++;\n        }\n\n        return new Uint8Array(dst.buffer, 0, dst_idx);\n    }\n\n    static parseSPS(uint8array) {\n        let rbsp = SPSParser._ebsp2rbsp(uint8array);\n        let gb = new ExpGolomb(rbsp);\n\n        gb.readByte();\n        let profile_idc = gb.readByte();  // profile_idc\n        gb.readByte();  // constraint_set_flags[5] + reserved_zero[3]\n        let level_idc = gb.readByte();  // level_idc\n        gb.readUEG();  // seq_parameter_set_id\n\n        let profile_string = SPSParser.getProfileString(profile_idc);\n        let level_string = SPSParser.getLevelString(level_idc);\n        let chroma_format_idc = 1;\n        let chroma_format = 420;\n        let chroma_format_table = [0, 420, 422, 444];\n        let bit_depth = 8;\n\n        if (profile_idc === 100 || profile_idc === 110 || profile_idc === 122 ||\n            profile_idc === 244 || profile_idc === 44 || profile_idc === 83 ||\n            profile_idc === 86 || profile_idc === 118 || profile_idc === 128 ||\n            profile_idc === 138 || profile_idc === 144) {\n\n            chroma_format_idc = gb.readUEG();\n            if (chroma_format_idc === 3) {\n                gb.readBits(1);  // separate_colour_plane_flag\n            }\n            if (chroma_format_idc <= 3) {\n                chroma_format = chroma_format_table[chroma_format_idc];\n            }\n\n            bit_depth = gb.readUEG() + 8;  // bit_depth_luma_minus8\n            gb.readUEG();  // bit_depth_chroma_minus8\n            gb.readBits(1);  // qpprime_y_zero_transform_bypass_flag\n            if (gb.readBool()) {  // seq_scaling_matrix_present_flag\n                let scaling_list_count = (chroma_format_idc !== 3) ? 8 : 12;\n                for (let i = 0; i < scaling_list_count; i++) {\n                    if (gb.readBool()) {  // seq_scaling_list_present_flag\n                        if (i < 6) {\n                            SPSParser._skipScalingList(gb, 16);\n                        } else {\n                            SPSParser._skipScalingList(gb, 64);\n                        }\n                    }\n                }\n            }\n        }\n        gb.readUEG();  // log2_max_frame_num_minus4\n        let pic_order_cnt_type = gb.readUEG();\n        if (pic_order_cnt_type === 0) {\n            gb.readUEG();  // log2_max_pic_order_cnt_lsb_minus_4\n        } else if (pic_order_cnt_type === 1) {\n            gb.readBits(1);  // delta_pic_order_always_zero_flag\n            gb.readSEG();  // offset_for_non_ref_pic\n            gb.readSEG();  // offset_for_top_to_bottom_field\n            let num_ref_frames_in_pic_order_cnt_cycle = gb.readUEG();\n            for (let i = 0; i < num_ref_frames_in_pic_order_cnt_cycle; i++) {\n                gb.readSEG();  // offset_for_ref_frame\n            }\n        }\n        let ref_frames = gb.readUEG();  // max_num_ref_frames\n        gb.readBits(1);  // gaps_in_frame_num_value_allowed_flag\n\n        let pic_width_in_mbs_minus1 = gb.readUEG();\n        let pic_height_in_map_units_minus1 = gb.readUEG();\n\n        let frame_mbs_only_flag = gb.readBits(1);\n        if (frame_mbs_only_flag === 0) {\n            gb.readBits(1);  // mb_adaptive_frame_field_flag\n        }\n        gb.readBits(1);  // direct_8x8_inference_flag\n\n        let frame_crop_left_offset = 0;\n        let frame_crop_right_offset = 0;\n        let frame_crop_top_offset = 0;\n        let frame_crop_bottom_offset = 0;\n\n        let frame_cropping_flag = gb.readBool();\n        if (frame_cropping_flag) {\n            frame_crop_left_offset = gb.readUEG();\n            frame_crop_right_offset = gb.readUEG();\n            frame_crop_top_offset = gb.readUEG();\n            frame_crop_bottom_offset = gb.readUEG();\n        }\n\n        let sar_width = 1, sar_height = 1;\n        let fps = 0, fps_fixed = true, fps_num = 0, fps_den = 0;\n\n        let vui_parameters_present_flag = gb.readBool();\n        if (vui_parameters_present_flag) {\n            if (gb.readBool()) {  // aspect_ratio_info_present_flag\n                let aspect_ratio_idc = gb.readByte();\n                let sar_w_table = [1, 12, 10, 16, 40, 24, 20, 32, 80, 18, 15, 64, 160, 4, 3, 2];\n                let sar_h_table = [1, 11, 11, 11, 33, 11, 11, 11, 33, 11, 11, 33,  99, 3, 2, 1];\n\n                if (aspect_ratio_idc > 0 && aspect_ratio_idc < 16) {\n                    sar_width = sar_w_table[aspect_ratio_idc - 1];\n                    sar_height = sar_h_table[aspect_ratio_idc - 1];\n                } else if (aspect_ratio_idc === 255) {\n                    sar_width = gb.readByte() << 8 | gb.readByte();\n                    sar_height = gb.readByte() << 8 | gb.readByte();\n                }\n            }\n\n            if (gb.readBool()) {  // overscan_info_present_flag\n                gb.readBool();  // overscan_appropriate_flag\n            }\n            if (gb.readBool()) {  // video_signal_type_present_flag\n                gb.readBits(4);  // video_format & video_full_range_flag\n                if (gb.readBool()) {  // colour_description_present_flag\n                    gb.readBits(24);  // colour_primaries & transfer_characteristics & matrix_coefficients\n                }\n            }\n            if (gb.readBool()) {  // chroma_loc_info_present_flag\n                gb.readUEG();  // chroma_sample_loc_type_top_field\n                gb.readUEG();  // chroma_sample_loc_type_bottom_field\n            }\n            if (gb.readBool()) {  // timing_info_present_flag\n                let num_units_in_tick = gb.readBits(32);\n                let time_scale = gb.readBits(32);\n                fps_fixed = gb.readBool();  // fixed_frame_rate_flag\n\n                fps_num = time_scale;\n                fps_den = num_units_in_tick * 2;\n                fps = fps_num / fps_den;\n            }\n        }\n\n        let sarScale = 1;\n        if (sar_width !== 1 || sar_height !== 1) {\n            sarScale = sar_width / sar_height;\n        }\n\n        let crop_unit_x = 0, crop_unit_y = 0;\n        if (chroma_format_idc === 0) {\n            crop_unit_x = 1;\n            crop_unit_y = 2 - frame_mbs_only_flag;\n        } else {\n            let sub_wc = (chroma_format_idc === 3) ? 1 : 2;\n            let sub_hc = (chroma_format_idc === 1) ? 2 : 1;\n            crop_unit_x = sub_wc;\n            crop_unit_y = sub_hc * (2 - frame_mbs_only_flag);\n        }\n\n        let codec_width = (pic_width_in_mbs_minus1 + 1) * 16;\n        let codec_height = (2 - frame_mbs_only_flag) * ((pic_height_in_map_units_minus1 + 1) * 16);\n\n        codec_width -= (frame_crop_left_offset + frame_crop_right_offset) * crop_unit_x;\n        codec_height -= (frame_crop_top_offset + frame_crop_bottom_offset) * crop_unit_y;\n\n        let present_width = Math.ceil(codec_width * sarScale);\n\n        gb.destroy();\n        gb = null;\n\n        return {\n            profile_string: profile_string,  // baseline, high, high10, ...\n            level_string: level_string,  // 3, 3.1, 4, 4.1, 5, 5.1, ...\n            bit_depth: bit_depth,  // 8bit, 10bit, ...\n            ref_frames: ref_frames,\n            chroma_format: chroma_format,  // 4:2:0, 4:2:2, ...\n            chroma_format_string: SPSParser.getChromaFormatString(chroma_format),\n\n            frame_rate: {\n                fixed: fps_fixed,\n                fps: fps,\n                fps_den: fps_den,\n                fps_num: fps_num\n            },\n\n            sar_ratio: {\n                width: sar_width,\n                height: sar_height\n            },\n\n            codec_size: {\n                width: codec_width,\n                height: codec_height\n            },\n\n            present_size: {\n                width: present_width,\n                height: codec_height\n            }\n        };\n    }\n\n    static _skipScalingList(gb, count) {\n        let last_scale = 8, next_scale = 8;\n        let delta_scale = 0;\n        for (let i = 0; i < count; i++) {\n            if (next_scale !== 0) {\n                delta_scale = gb.readSEG();\n                next_scale = (last_scale + delta_scale + 256) % 256;\n            }\n            last_scale = (next_scale === 0) ? last_scale : next_scale;\n        }\n    }\n\n    static getProfileString(profile_idc) {\n        switch (profile_idc) {\n            case 66:\n                return 'Baseline';\n            case 77:\n                return 'Main';\n            case 88:\n                return 'Extended';\n            case 100:\n                return 'High';\n            case 110:\n                return 'High10';\n            case 122:\n                return 'High422';\n            case 244:\n                return 'High444';\n            default:\n                return 'Unknown';\n        }\n    }\n\n    static getLevelString(level_idc) {\n        return (level_idc / 10).toFixed(1);\n    }\n\n    static getChromaFormatString(chroma) {\n        switch (chroma) {\n            case 420:\n                return '4:2:0';\n            case 422:\n                return '4:2:2';\n            case 444:\n                return '4:4:4';\n            default:\n                return 'Unknown';\n        }\n    }\n\n}\n\nexport default SPSParser;","/* eslint-disable no-case-declarations */\n\nimport Flv2canvasLoader from './flv2canvas.loader';\nimport YuvCanvas from './render/yuv-canvas';\nimport PCMPlayer from './audio/pcmplayer';\nclass flv2canvas {\n    constructor(options) {\n        this.playWidth = 0;\n        this.playHeight = 0;\n        this.videoBuffer = [];\n        this.videoDts = [];\n        this.audioDts = [];\n        this.audioDtsCur = 0;\n        this.startPlay = false;\n        this.options = options;\n        this.canvasObj = {};\n\n        this.initRender();\n        this.initAudio();\n    }\n\n    load() {\n        this.loader.load();\n    }\n\n    play(url) {\n        this.options.url = url;\n        this.loadCtl = new Flv2canvasLoader(this.options);\n        this.loadCtl.saveDts = this._saveDts.bind(this);\n        this.loader = this.loadCtl.createLoader();\n        this.initWorker();\n        this.startPlay = true;\n    }\n\n    stop() {\n        this.startPlay = false;\n    }\n\n    destory() {\n        console.log('关闭播放器');\n        let self = this;\n        this.avc = null;\n        this.videoDts = [];\n        this.videoBuffer = [];\n        this.audioDts = [];\n        this.loadCtl.destroy();\n        this.audioCtrl.destroy();\n        if (this.worker) {\n            this.worker.terminate();\n        }\n\n        window.cancelAnimationFrame(self.interval);\n    }\n\n    initAudio() {\n\n        // 新建音频播放器\n        this.audioCtrl = new PCMPlayer({\n            // sampleRate: sampleRate,\n            channels: 1\n        });\n    }\n\n    initWorker() {\n        this.worker = new Worker(this.options.workFile);\n        this.loadCtl.worker = this.worker;\n        this.worker.postMessage({\n            type: 'Broadway.js - Worker init', options: {\n                rgb: false,\n                memsize: '',\n                reuseMemory: true\n            }\n        });\n\n        let self = this;\n        this.worker.addEventListener('message', function (e) {\n            let data = e.data;\n            if (data.consoleLog) {\n                console.log(data.consoleLog);\n                return;\n            }\n\n            let type = e.data.type;\n            switch (type) {\n                case 'playAudio':\n                    let typeArr = e.data.buffer;\n                    let sampleRate = e.data.sampleRate;\n                    let dts = e.data.dts;\n                    if (!self.audioCtrl.sampleRate) {\n                        self.audioCtrl.sampleRate = sampleRate;\n                    }\n                    self.doSaveAudioDts(dts, typeArr);\n                    // if (self.audioDtsCur + 600 > self.videoDts[0]) return;\n                    // console.log(self.audioDtsCur, self.videoDts[0]);\n\n                    self.audioDtsCur = dts;\n                    // self.audioCtrl.feed(typeArr);\n                    break;\n\n                case 'playVideo':\n                    let typeArr2 = e.data.buffer;\n                    let width = e.data.width;\n                    let height = e.data.height;\n\n                    self.onPictureDecoded(typeArr2, width, height, data.infos);\n                    break;\n\n                case 'initFinished':\n                    self.load();\n                    break;\n            }\n\n        }, false);\n\n    }\n\n    initRender() {\n        let self = this;\n        this.renderFrame = this.renderFrameWebGL;\n        this.createCanvasObj = this.createCanvasWebGL;\n\n        this.canvasObj = this.createCanvasObj();\n        this.canvasObj.canvas = this.options.canvasDom;\n        let last = Date.now();\n        let diffTime = 0;\n        let noData = 0;\n        let fps = 20;\n        let interval = 1000 / fps;\n        let isLoading = false;\n\n        doRender();\n        function doRender() {\n            self.interval = requestAnimationFrame(doRender);\n            if (!self.startPlay) return;\n\n            // if (self.audioDts.length > 0) {\n            //     if (self.audioDts[0].dts < self.videoDts[0] + 1200) {\n            //         // console.log(self.audioDts[0].dts, self.videoDts[0])\n            //         console.log('声音慢了', self.audioDts.length);\n            //         self.audioDts.shift();\n            //         self.audioDts.shift();\n            //         self.audioDts.shift();\n            //     }\n            // }\n\n\n            if (self.audioDts.length > 0) {\n                self.audioCtrl.feed(self.audioDts[0].buffer);\n                self.audioDts.shift();\n\n            }\n\n            // 判断加载中\n            if (noData > 400) {\n                console.log('重启');\n                if (self.restart) {\n                    self.restart();\n                }\n            }\n            if (noData > 50 && !isLoading && self.showLoading) {\n                isLoading = true;\n                self.showLoading(true);\n            }\n\n            if (self.videoBuffer.length === 0 && self.hasFixPosition) {\n                // console.log('没有数据noData', noData);\n\n                noData++;\n                return;\n            }\n            if (isLoading && self.showLoading) {\n                self.showLoading(false);\n                isLoading = false;\n            }\n\n            noData = 0;\n\n            let now = Date.now();\n            diffTime = diffTime + (now - last);\n            last = Date.now();\n\n\n            // 减速\n            if (self.videoBuffer.length < 10) {\n                fps = 15;\n                interval = 1000 / fps;\n            }\n            // 加速\n            if (self.videoBuffer.length > 35) {\n                fps = 25;\n                interval = 1000 / fps;\n            }\n\n            if (self.videoBuffer.length > 25 && self.videoBuffer.length < 40) {\n                fps = 20;\n                interval = 1000 / fps;\n            }\n\n\n            // 满足帧数条件\n            if (diffTime < interval) {\n                return;\n            }\n\n            // 对比时间戳\n            if (self.audioDtsCur < self.videoDts[0] + 1200) {\n                return;\n            }\n\n            diffTime = diffTime % interval;\n            if (self.videoBuffer[0]) {\n                self.renderFrame({\n                    canvasObj: self.canvasObj,\n                    data: self.videoBuffer[0],\n                    width: self.playWidth,\n                    height: self.playHeight\n                });\n                self.videoDts.shift();\n                self.videoBuffer.shift();\n\n                if (!self.hasFixPosition) {\n                    if (self.fixPosition) {\n                        self.fixPosition();\n                    }\n                    if (self.showLoading) {\n                        self.showLoading(false);\n                    }\n\n                    console.log('Start to play,and fix position');\n                    self.hasFixPosition = true;\n                }\n            } else {\n                console.log('no data');\n            }\n        }\n    }\n    doSaveAudioDts(dts, buffer) {\n        if (document.hidden) return;\n        if (!this.startPlay) return;\n        this.audioDts.push({\n            dts: dts,\n            buffer: buffer\n        });\n    }\n\n    _saveDts(dts) {\n\n        let videoDts = this.videoDts;\n        if (videoDts.length === 0) {\n            this.videoDts.push(dts);\n        } else if (videoDts.length === 1) {\n            if (dts > videoDts[0]) {\n                this.videoDts.push(dts);\n            } else {\n                this.videoDts.unshift(dts);\n            }\n        }\n        else {\n            let isPush = false;\n            for (let i = 0; i < this.videoDts.length; i++) {\n                if (dts < this.videoDts[i] || dts === this.videoDts[i]) {\n\n                    let arr1 = videoDts.slice(0, i);\n                    let arr2 = videoDts.slice(i, videoDts.length);\n                    arr1.push(dts);\n                    this.videoDts = arr1.concat(arr2);\n\n                    isPush = true;\n                    break;\n                }\n            }\n\n            if (!isPush) {\n                this.videoDts.push(dts);\n            }\n\n        }\n\n\n    }\n\n    onPictureDecoded(buffer, width, height, infos) {\n        if (document.hidden) return;\n        this.playWidth = width;\n        this.playHeight = height;\n        this.videoBuffer.push(new Uint8Array(buffer));\n        let self = this;\n        if (this.videoBuffer.length > 50 && !this.startPlay) {\n            console.log('clear', this.videoBuffer.length, this.videoDts.length);\n            this.videoBuffer = [];\n            self.videoDts = [];\n            let i = 0;\n            while (i < 50) {\n                self.videoDts.shift();\n                i++;\n            }\n        }\n    }\n\n    renderFrameWebGL(options) {\n        let canvasObj = options.canvasObj;\n        let width = options.width || canvasObj.canvas.width;\n        let height = options.height || canvasObj.canvas.height;\n        if (canvasObj.canvas.width !== width || canvasObj.canvas.height !== height || !canvasObj.webGLCanvas) {\n\n            canvasObj.canvas.width = width;\n            canvasObj.canvas.height = height;\n            canvasObj.webGLCanvas = new YuvCanvas({\n                canvas: canvasObj.canvas,\n                contextOptions: canvasObj.contextOptions,\n                width: width,\n                height: height\n            });\n        }\n\n        let ylen = width * height;\n        let uvlen = (width / 2) * (height / 2);\n        canvasObj.webGLCanvas.drawNextOutputPicture({\n            yData: options.data.subarray(0, ylen),\n            uData: options.data.subarray(ylen, ylen + uvlen),\n            vData: options.data.subarray(ylen + uvlen, ylen + uvlen + uvlen)\n        });\n\n        let self = this;\n        self.recycleMemory(options.data);\n    }\n\n    recycleMemory(parArray) {\n        this.worker.postMessage({ reuse: parArray.buffer }, [parArray.buffer]);\n    }\n\n    createCanvasWebGL(options) {\n        let canvasObj = this._createBasicCanvasObj(options);\n        // canvasObj.contextOptions = options.contextOptions;\n        return canvasObj;\n    }\n\n    _createBasicCanvasObj(options) {\n        options = options || {};\n\n        let obj = {};\n\n        obj.canvas = document.createElement('canvas');\n\n        obj.canvas.style.backgroundColor = '#0D0E1B';\n\n\n        return obj;\n    }\n\n}\nexport default flv2canvas;","import Polyfill from './utils/polyfill.js';\nimport IOController from './loader/io-controller';\n// install polyfills\nPolyfill.install();\n\n\n// feature detection\nfunction isSupported() {\n    return true;\n}\n\n\n// flv2canvasLoader.getFeatureList = getFeatureList;\n\n// flv2canvasLoader.BaseLoader = BaseLoader;\n// flv2canvasLoader.LoaderStatus = LoaderStatus;\n// flv2canvasLoader.LoaderErrors = LoaderErrors;\n\n// flv2canvasLoader.Events = PlayerEvents;\n// flv2canvasLoader.ErrorTypes = ErrorTypes;\n// flv2canvasLoader.ErrorDetails = ErrorDetails;\n\n// flv2canvasLoader.FlvPlayer = FlvPlayer;\n// flv2canvasLoader.LoggingControl = LoggingControl;\n\nclass Flv2CanvasLoader {\n    constructor(optionalConfig) {\n        this._config = optionalConfig;\n    }\n\n    createLoader() {\n        this.ioctl = new IOController(this._config);\n        this.ioctl.onVideoParseDone = this._onVideoParseDone.bind(this);\n        this.ioctl.onAudioParseDone = this._onAudioParseDone.bind(this);\n        this.ioctl.saveDts = this._saveDts.bind(this);\n        return this.ioctl;\n    }\n\n    _onVideoParseDone(data) {\n        // post video h264 to woker\n        // console.log(this.worker);\n        this.worker.postMessage({\n            type: 'sendArrayVideo',\n            buffer: data\n        });\n    }\n\n    _saveDts(data) {\n        this.saveDts(data);\n\n    }\n    _onAudioParseDone(data) {\n        // post audio to woker\n        this.worker.postMessage({\n            type: 'sendArrayAudio',\n            buffer: data\n        });\n    }\n\n    destroy() {\n        this.ioctl.destroy();\n    }\n}\n\n\nexport default Flv2CanvasLoader;","module.exports = require('./flv2canvas.js').default;","/*\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\n *\n * @author zheng qian <xqq@xqq.im>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// import Log from '../utils/logger.js';\nimport Browser from '../utils/browser.js';\nimport { BaseLoader, LoaderStatus, LoaderErrors } from './loader.js';\n// import {RuntimeException} from '../utils/exception.js';\n\n/* fetch + stream IO loader. Currently working on chrome 43+.\n * fetch provides a better alternative http API to XMLHttpRequest\n *\n * fetch spec   https://fetch.spec.whatwg.org/\n * stream spec  https://streams.spec.whatwg.org/\n */\nclass FetchStreamLoader extends BaseLoader {\n\n    static isSupported() {\n        try {\n            // fetch + stream is broken on Microsoft Edge. Disable before build 15048.\n            // see https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8196907/\n            // Fixed in Jan 10, 2017. Build 15048+ removed from blacklist.\n            let isWorkWellEdge = Browser.msedge && Browser.version.minor >= 15048;\n            let browserNotBlacklisted = Browser.msedge ? isWorkWellEdge : true;\n            return (self.fetch && self.ReadableStream && browserNotBlacklisted);\n        } catch (e) {\n            return false;\n        }\n    }\n\n    constructor(config) {\n        super('fetch-stream-loader');\n        this.TAG = 'FetchStreamLoader';\n\n        this._config = config;\n        this._needStash = true;\n\n        this._requestAbort = false;\n        this._contentLength = null;\n        this._receivedLength = 0;\n    }\n\n    destroy() {\n        if (this.isWorking()) {\n            this.abort();\n        }\n        super.destroy();\n    }\n\n    open() {\n        let headers = new self.Headers();\n\n\n        let params = {\n            method: 'GET',\n            headers: headers,\n            mode: 'cors',\n            cache: 'default',\n            // The default policy of Fetch API in the whatwg standard\n            // Safari incorrectly indicates 'no-referrer' as default policy, fuck it\n            referrerPolicy: 'no-referrer-when-downgrade'\n        };\n\n        // add additional headers\n        if (typeof this._config.headers === 'object') {\n            for (let key in this._config.headers) {\n                headers.append(key, this._config.headers[key]);\n            }\n        }\n\n\n        this._status = LoaderStatus.kConnecting;\n        self.fetch(this._config.url, params).then((res) => {\n            if (res.ok && (res.status >= 200 && res.status <= 299)) {\n                let lengthHeader = res.headers.get('Content-Length');\n                if (lengthHeader != null) {\n                    this._contentLength = parseInt(lengthHeader);\n                    if (this._contentLength !== 0) {\n                        if (this._onContentLengthKnown) {\n                            this._onContentLengthKnown(this._contentLength);\n                        }\n                    }\n                }\n                return this._pump.call(this, res.body.getReader());\n            } else {\n                this._status = LoaderStatus.kError;\n                if (this._onError) {\n                    this._onError(LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: res.status, msg: res.statusText });\n                } else {\n                    // throw new RuntimeException('FetchStreamLoader: Http code invalid, ' + res.status + ' ' + res.statusText);\n                }\n            }\n        }).catch((e) => {\n            this._status = LoaderStatus.kError;\n            if (this._onError) {\n                this._onError(LoaderErrors.EXCEPTION, { code: -1, msg: e.message });\n            } else {\n                throw e;\n            }\n        });\n    }\n\n    abort() {\n        this._requestAbort = true;\n    }\n\n    _pump(reader) {  // ReadableStreamReader\n\n        return reader.read().then((result) => {\n\n            if (result.done) {\n\n                if (this._requestAbort === true) {\n                    this._requestAbort = false;\n                    this._status = LoaderStatus.kComplete;\n                    return reader.cancel();\n                }\n\n                this._status = LoaderStatus.kBuffering;\n\n                let chunk = result.value.buffer;\n                let byteStart = this._range.from + this._receivedLength;\n                this._receivedLength += chunk.byteLength;\n                if (this._onDataArrival) {\n                    this._onDataArrival(chunk, byteStart, this._receivedLength);\n                }\n                this._pump(reader);\n            } else {\n                if (this._requestAbort === true) {\n                    this._requestAbort = false;\n                    this._status = LoaderStatus.kComplete;\n                    return reader.cancel();\n                }\n\n                this._status = LoaderStatus.kBuffering;\n\n                let chunk = result.value.buffer;\n\n                let byteStart = this._receivedLength;\n\n                this._receivedLength += chunk.byteLength;\n                if (this._onDataArrival) {\n                    try {\n                        this._onDataArrival(chunk, byteStart, this._receivedLength);\n                        \n                    } catch (error) {\n                        console.log(error);\n                    }\n                }\n\n                this._pump(reader);\n            }\n        }).catch((e) => {\n            if (e.code === 11 && Browser.msedge) {  // InvalidStateError on Microsoft Edge\n                // Workaround: Edge may throw InvalidStateError after ReadableStreamReader.cancel() call\n                // Ignore the unknown exception.\n                // Related issue: https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/11265202/\n                return;\n            }\n\n            this._status = LoaderStatus.kError;\n            let type = 0;\n            let info = null;\n\n            if ((e.code === 19 || e.message === 'network error') && // NETWORK_ERR\n                (this._contentLength === null ||\n                    (this._contentLength !== null && this._receivedLength < this._contentLength))) {\n                type = LoaderErrors.EARLY_EOF;\n                info = { code: e.code, msg: 'Fetch stream meet Early-EOF' };\n            } else {\n                type = LoaderErrors.EXCEPTION;\n                info = { code: e.code, msg: e.message };\n            }\n\n            if (this._onError) {\n                this._onError(type, info);\n            } else {\n                // throw new RuntimeException(info.msg);\n            }\n        });\n    }\n\n}\n\nexport default FetchStreamLoader;\n","\nimport FetchStreamLoader from './fetch-stream-loader.js';\n// import MozChunkedLoader from './xhr-moz-chunked-loader.js';\n// import {RuntimeException} from '../utils/exception.js';\nimport EventEmitter from 'events';\nimport FLVDemuxer from '../demux/flv-demuxer.js';\nimport SpeedSampler from './speed-sampler.js';\n\n\nclass IOController {\n    constructor(config) {\n        this._config = config;\n        this._loader = null;\n        this._loaderClass = null;\n        this._seekHandler = null;\n\n\n        this._emitter = new EventEmitter();\n\n        this._stashUsed = 0;\n        this._stashSize = this._stashInitialSize;\n        this._bufferSize = 1024 * 1024 * 3;  // initial size: 3MB\n        this._stashBuffer = new ArrayBuffer(this._bufferSize);\n        this._stashByteStart = 0;\n        this._enableStash = false;\n        if (config.enableStashBuffer === false) {\n            this._enableStash = false;\n        }\n\n\n\n        this._totalLength = this._refTotalLength;\n        this._fullRequestFlag = false;\n        this._currentRange = null;\n        this._redirectedURL = null;\n        this._speedNormalized = 0;\n        this._speedSampler = new SpeedSampler();\n        this._speedNormalizeList = [64, 128, 256, 384, 512, 768, 1024, 1536, 2048, 3072, 4096];\n\n        this._selectLoader();\n        this._createLoader();\n    }\n\n    _selectLoader() {\n        if (FetchStreamLoader.isSupported()) {\n            this._loaderClass = FetchStreamLoader;\n        }\n        // else if (MozChunkedLoader.isSupported()) {\n        //     this._loaderClass = MozChunkedLoader;\n        // }  else {\n        //     throw new RuntimeException('Your browser doesn\\'t support xhr with arraybuffer responseType!');\n        // }\n    }\n\n    _createLoader() {\n        this._loader = new this._loaderClass(this._config);\n        if (this._loader.needStashBuffer === false) {\n            this._enableStash = false;\n        }\n        // this._loader.onContentLengthKnown = this._onContentLengthKnown.bind(this);\n        // this._loader.onURLRedirect = this._onURLRedirect.bind(this);\n        // this._loader.onDataArrival = this._onLoaderChunkArrival.bind(this);\n        // this._loader.onComplete = this._onLoaderComplete.bind(this);\n        // this._loader.onError = this._onLoaderError.bind(this);\n    }\n\n    load() {\n        this._loader.onDataArrival = this._onLoaderChunkArrival.bind(this);\n        this._loader.open();\n    }\n\n    _onInitChunkArrival(data, byteStart) {\n\n        let probeData = null;\n        let consumed = 0;\n        if (byteStart > 0) {\n            // IOController seeked immediately after opened, byteStart > 0 callback may received\n            this._demuxer.bindDataSource(this._loader);\n\n            consumed = this._demuxer.parseChunks(data, byteStart);\n        } else if ((probeData = FLVDemuxer.probe(data)).match) {\n            // Always create new FLVDemuxer\n            this._demuxer = new FLVDemuxer(probeData, this._config);\n            this._demuxer.onVideoParseDone = this._onVideoParseDone.bind(this);\n            this._demuxer.onAudioParseDone = this._onAudioParseDone.bind(this);\n            this._demuxer.saveDts = this._saveDts.bind(this);\n\n            // if (!this._remuxer) {\n            //     this._remuxer = new MP4Remuxer(this._config);\n            // }\n\n            // let mds = this._mediaDataSource;\n            // if (mds.duration != undefined && !isNaN(mds.duration)) {\n            //     this._demuxer.overridedDuration = mds.duration;\n            // }\n            // if (typeof mds.hasAudio === 'boolean') {\n            //     this._demuxer.overridedHasAudio = mds.hasAudio;\n            // }\n            // if (typeof mds.hasVideo === 'boolean') {\n            //     this._demuxer.overridedHasVideo = mds.hasVideo;\n            // }\n\n            // this._demuxer.timestampBase = mds.segments[this._currentSegmentIndex].timestampBase;\n\n            // this._demuxer.onError = this._onDemuxException.bind(this);\n            // this._demuxer.onMediaInfo = this._onMediaInfo.bind(this);\n            // this._demuxer.onMetaDataArrived = this._onMetaDataArrived.bind(this);\n            this._demuxer.onScriptDataArrived = this._onScriptDataArrived.bind(this);\n\n            // this._remuxer.bindDataSource(this._demuxer\n            //              .bindDataSource(this._ioctl\n            // ));\n\n            // this._remuxer.onInitSegment = this._onRemuxerInitSegmentArrival.bind(this);\n            // this._remuxer.onMediaSegment = this._onRemuxerMediaSegmentArrival.bind(this);\n\n            consumed = this._demuxer.parseChunks(data, byteStart);\n        } else {\n            probeData = null;\n            // Log.e(this.TAG, 'Non-FLV, Unsupported media type!');\n\n        }\n\n        return consumed;\n    }\n\n    _normalizeSpeed(input) {\n        let list = this._speedNormalizeList;\n        let last = list.length - 1;\n        let mid = 0;\n        let lbound = 0;\n        let ubound = last;\n\n        if (input < list[0]) {\n            return list[0];\n        }\n\n        // binary search\n        while (lbound <= ubound) {\n            mid = lbound + Math.floor((ubound - lbound) / 2);\n            if (mid === last || (input >= list[mid] && input < list[mid + 1])) {\n                return list[mid];\n            } else if (list[mid] < input) {\n                lbound = mid + 1;\n            } else {\n                ubound = mid - 1;\n            }\n        }\n    }\n\n    _onLoaderChunkArrival(chunk, byteStart, receivedLength) {\n        try {\n            if (!this._onDataArrival) {\n                // throw new IllegalStateException('IOController: No existing consumer (onDataArrival) callback!');\n            }\n            if (this._paused) {\n                return;\n            }\n            if (this._isEarlyEofReconnecting) {\n                // Auto-reconnect for EarlyEof succeed, notify to upper-layer by callback\n                this._isEarlyEofReconnecting = false;\n                if (this._onRecoveredEarlyEof) {\n                    this._onRecoveredEarlyEof();\n                }\n            }\n\n            this._speedSampler.addBytes(chunk.byteLength);\n\n            // adjust stash buffer size according to network speed dynamically\n            let KBps = this._speedSampler.lastSecondKBps;\n            if (KBps !== 0) {\n                let normalized = this._normalizeSpeed(KBps);\n                if (this._speedNormalized !== normalized) {\n                    this._speedNormalized = normalized;\n                    this._adjustStashSize(normalized);\n                }\n            }\n\n            if (!this._enableStash) {  // disable stash\n                if (this._stashUsed === 0) {\n                    // dispatch chunk directly to consumer;\n                    // check ret value (consumed bytes) and stash unconsumed to stashBuffer\n                    let consumed = this._dispatchChunks(chunk, byteStart);\n                    if (consumed < chunk.byteLength) {  // unconsumed data remain.\n                        let remain = chunk.byteLength - consumed;\n                        if (remain > this._bufferSize) {\n                            this._expandBuffer(remain);\n                        }\n                        let stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                        stashArray.set(new Uint8Array(chunk, consumed), 0);\n                        this._stashUsed += remain;\n                        this._stashByteStart = byteStart + consumed;\n                    }\n                } else {\n                    // else: Merge chunk into stashBuffer, and dispatch stashBuffer to consumer.\n                    if (this._stashUsed + chunk.byteLength > this._bufferSize) {\n                        this._expandBuffer(this._stashUsed + chunk.byteLength);\n                    }\n                    let stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                    stashArray.set(new Uint8Array(chunk), this._stashUsed);\n                    this._stashUsed += chunk.byteLength;\n                    let consumed = this._dispatchChunks(this._stashBuffer.slice(0, this._stashUsed), this._stashByteStart);\n                    if (consumed < this._stashUsed && consumed > 0) {  // unconsumed data remain\n                        let remainArray = new Uint8Array(this._stashBuffer, consumed);\n                        stashArray.set(remainArray, 0);\n                    }\n                    this._stashUsed -= consumed;\n                    this._stashByteStart += consumed;\n                }\n            } else {  // enable stash\n                if (this._stashUsed === 0 && this._stashByteStart === 0) {  // seeked? or init chunk?\n                    // This is the first chunk after seek action\n                    this._stashByteStart = byteStart;\n                }\n                if (this._stashUsed + chunk.byteLength <= this._stashSize) {\n                    // just stash\n                    let stashArray = new Uint8Array(this._stashBuffer, 0, this._stashSize);\n                    stashArray.set(new Uint8Array(chunk), this._stashUsed);\n                    this._stashUsed += chunk.byteLength;\n                } else {  // stashUsed + chunkSize > stashSize, size limit exceeded\n                    let stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                    if (this._stashUsed > 0) {  // There're stash datas in buffer\n                        // dispatch the whole stashBuffer, and stash remain data\n                        // then append chunk to stashBuffer (stash)\n                        let buffer = this._stashBuffer.slice(0, this._stashUsed);\n                        let consumed = this._dispatchChunks(buffer, this._stashByteStart);\n                        if (consumed < buffer.byteLength) {\n                            if (consumed > 0) {\n                                let remainArray = new Uint8Array(buffer, consumed);\n                                stashArray.set(remainArray, 0);\n                                this._stashUsed = remainArray.byteLength;\n                                this._stashByteStart += consumed;\n                            }\n                        } else {\n                            this._stashUsed = 0;\n                            this._stashByteStart += consumed;\n                        }\n                        if (this._stashUsed + chunk.byteLength > this._bufferSize) {\n                            this._expandBuffer(this._stashUsed + chunk.byteLength);\n                            stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                        }\n                        stashArray.set(new Uint8Array(chunk), this._stashUsed);\n                        this._stashUsed += chunk.byteLength;\n                    } else {  // stash buffer empty, but chunkSize > stashSize (oh, holy shit)\n                        // dispatch chunk directly and stash remain data\n                        let consumed = this._dispatchChunks(chunk, byteStart);\n                        if (consumed < chunk.byteLength) {\n                            let remain = chunk.byteLength - consumed;\n                            if (remain > this._bufferSize) {\n                                this._expandBuffer(remain);\n                                stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                            }\n                            stashArray.set(new Uint8Array(chunk, consumed), 0);\n                            this._stashUsed += remain;\n                            this._stashByteStart = byteStart + consumed;\n                        }\n                    }\n                }\n            }\n        } catch (error) {\n            console.log(error);\n        }\n\n\n\n    }\n\n    _adjustStashSize(normalized) {\n        let stashSizeKB = 0;\n\n        if (this._config.isLive) {\n            // live stream: always use single normalized speed for size of stashSizeKB\n            stashSizeKB = normalized;\n        } else {\n            if (normalized < 512) {\n                stashSizeKB = normalized;\n            } else if (normalized >= 512 && normalized <= 1024) {\n                stashSizeKB = Math.floor(normalized * 1.5);\n            } else {\n                stashSizeKB = normalized * 2;\n            }\n        }\n\n        if (stashSizeKB > 8192) {\n            stashSizeKB = 8192;\n        }\n\n        let bufferSize = stashSizeKB * 1024 + 1024 * 1024 * 1;  // stashSize + 1MB\n        if (this._bufferSize < bufferSize) {\n            this._expandBuffer(bufferSize);\n        }\n        this._stashSize = stashSizeKB * 1024;\n    }\n\n    _expandBuffer(expectedBytes) {\n        let bufferNewSize = this._stashSize;\n        while (bufferNewSize + 1024 * 1024 * 1 < expectedBytes) {\n            bufferNewSize *= 2;\n        }\n\n        bufferNewSize += 1024 * 1024 * 1;  // bufferSize = stashSize + 1MB\n        if (bufferNewSize === this._bufferSize) {\n            return;\n        }\n\n        let newBuffer = new ArrayBuffer(bufferNewSize);\n\n        if (this._stashUsed > 0) {  // copy existing data into new buffer\n            let stashOldArray = new Uint8Array(this._stashBuffer, 0, this._stashUsed);\n            let stashNewArray = new Uint8Array(newBuffer, 0, bufferNewSize);\n            stashNewArray.set(stashOldArray, 0);\n        }\n\n        this._stashBuffer = newBuffer;\n        this._bufferSize = bufferNewSize;\n    }\n\n    _dispatchChunks(chunks, byteStart) {\n        // this._currentRange.to = byteStart + chunks.byteLength - 1;\n        return this._onInitChunkArrival(chunks, byteStart);\n    }\n\n    _onScriptDataArrived(data) {\n        // this._emitter.emit(TransmuxingEvents.SCRIPTDATA_ARRIVED, data);\n    }\n\n    _onVideoParseDone(data) {\n        this.onVideoParseDone(data);\n    }\n\n    _onAudioParseDone(data) {\n        this.onAudioParseDone(data);\n    }\n\n    _saveDts(data) {\n        this.saveDts(data);\n    }\n\n    destroy() {\n        this._loader.destroy();\n    }\n\n    onVideoParseDone() { }\n\n    onAudioParseDone() { }\n}\n\nexport default IOController;","/*\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\n *\n * @author zheng qian <xqq@xqq.im>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// import {NotImplementedException} from '../utils/exception.js';\n\nexport const LoaderStatus = {\n    kIdle: 0,\n    kConnecting: 1,\n    kBuffering: 2,\n    kError: 3,\n    kComplete: 4\n};\n\nexport const LoaderErrors = {\n    OK: 'OK',\n    EXCEPTION: 'Exception',\n    HTTP_STATUS_CODE_INVALID: 'HttpStatusCodeInvalid',\n    CONNECTING_TIMEOUT: 'ConnectingTimeout',\n    EARLY_EOF: 'EarlyEof',\n    UNRECOVERABLE_EARLY_EOF: 'UnrecoverableEarlyEof'\n};\n\n/* Loader has callbacks which have following prototypes:\n *     function onContentLengthKnown(contentLength: number): void\n *     function onURLRedirect(url: string): void\n *     function onDataArrival(chunk: ArrayBuffer, byteStart: number, receivedLength: number): void\n *     function onError(errorType: number, errorInfo: {code: number, msg: string}): void\n *     function onComplete(rangeFrom: number, rangeTo: number): void\n */\nexport class BaseLoader {\n\n    constructor(typeName) {\n        this._type = typeName || 'undefined';\n        this._status = LoaderStatus.kIdle;\n        this._needStash = false;\n        // callbacks\n        this._onContentLengthKnown = null;\n        this._onURLRedirect = null;\n        this._onDataArrival = null;\n        this._onError = null;\n        this._onComplete = null;\n    }\n\n    destroy() {\n        this._status = LoaderStatus.kIdle;\n        this._onContentLengthKnown = null;\n        this._onURLRedirect = null;\n        this._onDataArrival = null;\n        this._onError = null;\n        this._onComplete = null;\n    }\n\n    isWorking() {\n        return this._status === LoaderStatus.kConnecting || this._status === LoaderStatus.kBuffering;\n    }\n\n    get type() {\n        return this._type;\n    }\n\n    get status() {\n        return this._status;\n    }\n\n    get needStashBuffer() {\n        return this._needStash;\n    }\n\n    get onContentLengthKnown() {\n        return this._onContentLengthKnown;\n    }\n\n    set onContentLengthKnown(callback) {\n        this._onContentLengthKnown = callback;\n    }\n\n    get onURLRedirect() {\n        return this._onURLRedirect;\n    }\n\n    set onURLRedirect(callback) {\n        this._onURLRedirect = callback;\n    }\n\n    get onDataArrival() {\n        return this._onDataArrival;\n    }\n\n    set onDataArrival(callback) {\n        this._onDataArrival = callback;\n    }\n\n    get onError() {\n        return this._onError;\n    }\n\n    set onError(callback) {\n        this._onError = callback;\n    }\n\n    get onComplete() {\n        return this._onComplete;\n    }\n\n    set onComplete(callback) {\n        this._onComplete = callback;\n    }\n\n    // pure virtual\n    open(dataSource, range) {\n        // throw new NotImplementedException('Unimplemented abstract function!');\n    }\n\n    abort() {\n        // throw new NotImplementedException('Unimplemented abstract function!');\n    }\n\n\n}","/*\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\n *\n * @author zheng qian <xqq@xqq.im>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Utility class to calculate realtime network I/O speed\nclass SpeedSampler {\n\n    constructor() {\n        // milliseconds\n        this._firstCheckpoint = 0;\n        this._lastCheckpoint = 0;\n        this._intervalBytes = 0;\n        this._totalBytes = 0;\n        this._lastSecondBytes = 0;\n\n        // compatibility detection\n        if (self.performance && self.performance.now) {\n            this._now = self.performance.now.bind(self.performance);\n        } else {\n            this._now = Date.now;\n        }\n    }\n\n    reset() {\n        this._firstCheckpoint = this._lastCheckpoint = 0;\n        this._totalBytes = this._intervalBytes = 0;\n        this._lastSecondBytes = 0;\n    }\n\n    addBytes(bytes) {\n        if (this._firstCheckpoint === 0) {\n            this._firstCheckpoint = this._now();\n            this._lastCheckpoint = this._firstCheckpoint;\n            this._intervalBytes += bytes;\n            this._totalBytes += bytes;\n        } else if (this._now() - this._lastCheckpoint < 1000) {\n            this._intervalBytes += bytes;\n            this._totalBytes += bytes;\n        } else {  // duration >= 1000\n            this._lastSecondBytes = this._intervalBytes;\n            this._intervalBytes = bytes;\n            this._totalBytes += bytes;\n            this._lastCheckpoint = this._now();\n        }\n    }\n\n    get currentKBps() {\n        this.addBytes(0);\n\n        let durationSeconds = (this._now() - this._lastCheckpoint) / 1000;\n        if (durationSeconds == 0) durationSeconds = 1;\n        return (this._intervalBytes / durationSeconds) / 1024;\n    }\n\n    get lastSecondKBps() {\n        this.addBytes(0);\n\n        if (this._lastSecondBytes !== 0) {\n            return this._lastSecondBytes / 1024;\n        } else {  // lastSecondBytes === 0\n            if (this._now() - this._lastCheckpoint >= 500) {\n                // if time interval since last checkpoint has exceeded 500ms\n                // the speed is nearly accurate\n                return this.currentKBps;\n            } else {\n                // We don't know\n                return 0;\n            }\n        }\n    }\n\n    get averageKBps() {\n        let durationSeconds = (this._now() - this._firstCheckpoint) / 1000;\n        return (this._totalBytes / durationSeconds) / 1024;\n    }\n\n}\n\nexport default SpeedSampler;","class YUVCanvas {\n    constructor(parOptions) {\n        parOptions = parOptions || {};\n\n        this.canvasElement = parOptions.canvas || document.createElement('canvas');\n        this.contextOptions = parOptions.contextOptions;\n\n        this.type = parOptions.type || 'yuv420';\n\n        this.customYUV444 = parOptions.customYUV444;\n\n        this.conversionType = parOptions.conversionType || 'rec601';\n\n        this.width = parOptions.width || 640;\n        this.height = parOptions.height || 320;\n\n        this.animationTime = parOptions.animationTime || 0;\n\n        this.canvasElement.width = this.width;\n        this.canvasElement.height = this.height;\n\n        this.initContextGL();\n\n        if (this.contextGL) {\n            this.initProgram();\n            this.initBuffers();\n            this.initTextures();\n        }\n\n        /**\n         * Draw the next output picture using WebGL\n         */\n        if (this.type === 'yuv420') {\n            this.drawNextOuptutPictureGL = function (par) {\n                let gl = this.contextGL;\n                let texturePosBuffer = this.texturePosBuffer;\n                let uTexturePosBuffer = this.uTexturePosBuffer;\n                let vTexturePosBuffer = this.vTexturePosBuffer;\n\n                let yTextureRef = this.yTextureRef;\n                let uTextureRef = this.uTextureRef;\n                let vTextureRef = this.vTextureRef;\n\n                let yData = par.yData;\n                let uData = par.uData;\n                let vData = par.vData;\n\n                let width = this.width;\n                let height = this.height;\n\n                let yDataPerRow = par.yDataPerRow || width;\n                let yRowCnt = par.yRowCnt || height;\n\n                let uDataPerRow = par.uDataPerRow || (width / 2);\n                let uRowCnt = par.uRowCnt || (height / 2);\n\n                let vDataPerRow = par.vDataPerRow || uDataPerRow;\n                let vRowCnt = par.vRowCnt || uRowCnt;\n\n                gl.viewport(0, 0, width, height);\n\n                let tTop = 0;\n                let tLeft = 0;\n                let tBottom = height / yRowCnt;\n                let tRight = width / yDataPerRow;\n                let texturePosValues = new Float32Array([tRight, tTop, tLeft, tTop, tRight, tBottom, tLeft, tBottom]);\n\n                gl.bindBuffer(gl.ARRAY_BUFFER, texturePosBuffer);\n                gl.bufferData(gl.ARRAY_BUFFER, texturePosValues, gl.DYNAMIC_DRAW);\n\n                if (this.customYUV444) {\n                    tBottom = height / uRowCnt;\n                    tRight = width / uDataPerRow;\n                } else {\n                    tBottom = (height / 2) / uRowCnt;\n                    tRight = (width / 2) / uDataPerRow;\n                }\n                let uTexturePosValues = new Float32Array([tRight, tTop, tLeft, tTop, tRight, tBottom, tLeft, tBottom]);\n\n                gl.bindBuffer(gl.ARRAY_BUFFER, uTexturePosBuffer);\n                gl.bufferData(gl.ARRAY_BUFFER, uTexturePosValues, gl.DYNAMIC_DRAW);\n\n\n                if (this.customYUV444) {\n                    tBottom = height / vRowCnt;\n                    tRight = width / vDataPerRow;\n                } else {\n                    tBottom = (height / 2) / vRowCnt;\n                    tRight = (width / 2) / vDataPerRow;\n                }\n                let vTexturePosValues = new Float32Array([tRight, tTop, tLeft, tTop, tRight, tBottom, tLeft, tBottom]);\n\n                gl.bindBuffer(gl.ARRAY_BUFFER, vTexturePosBuffer);\n                gl.bufferData(gl.ARRAY_BUFFER, vTexturePosValues, gl.DYNAMIC_DRAW);\n\n\n                gl.activeTexture(gl.TEXTURE0);\n                gl.bindTexture(gl.TEXTURE_2D, yTextureRef);\n                gl.texImage2D(gl.TEXTURE_2D, 0, gl.LUMINANCE, yDataPerRow, yRowCnt, 0, gl.LUMINANCE, gl.UNSIGNED_BYTE, yData);\n\n                gl.activeTexture(gl.TEXTURE1);\n                gl.bindTexture(gl.TEXTURE_2D, uTextureRef);\n                gl.texImage2D(gl.TEXTURE_2D, 0, gl.LUMINANCE, uDataPerRow, uRowCnt, 0, gl.LUMINANCE, gl.UNSIGNED_BYTE, uData);\n\n                gl.activeTexture(gl.TEXTURE2);\n                gl.bindTexture(gl.TEXTURE_2D, vTextureRef);\n                gl.texImage2D(gl.TEXTURE_2D, 0, gl.LUMINANCE, vDataPerRow, vRowCnt, 0, gl.LUMINANCE, gl.UNSIGNED_BYTE, vData);\n\n                gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n            };\n\n        } else if (this.type === 'yuv422') {\n            this.drawNextOuptutPictureGL = function (par) {\n                let gl = this.contextGL;\n                let texturePosBuffer = this.texturePosBuffer;\n\n                let textureRef = this.textureRef;\n\n                let data = par.data;\n\n                let width = this.width;\n                let height = this.height;\n\n                let dataPerRow = par.dataPerRow || (width * 2);\n                let rowCnt = par.rowCnt || height;\n\n                gl.viewport(0, 0, width, height);\n\n                let tTop = 0;\n                let tLeft = 0;\n                let tBottom = height / rowCnt;\n                let tRight = width / (dataPerRow / 2);\n                let texturePosValues = new Float32Array([tRight, tTop, tLeft, tTop, tRight, tBottom, tLeft, tBottom]);\n\n                gl.bindBuffer(gl.ARRAY_BUFFER, texturePosBuffer);\n                gl.bufferData(gl.ARRAY_BUFFER, texturePosValues, gl.DYNAMIC_DRAW);\n\n                gl.uniform2f(gl.getUniformLocation(this.shaderProgram, 'resolution'), dataPerRow, height);\n\n                gl.activeTexture(gl.TEXTURE0);\n                gl.bindTexture(gl.TEXTURE_2D, textureRef);\n                gl.texImage2D(gl.TEXTURE_2D, 0, gl.LUMINANCE, dataPerRow, rowCnt, 0, gl.LUMINANCE, gl.UNSIGNED_BYTE, data);\n\n                gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n            };\n        }\n\n    }\n\n    isWebGL() {\n        return this.contextGL;\n    }\n\n    initContextGL() {\n        let canvas = this.canvasElement;\n        let gl = null;\n    \n        let validContextNames = ['webgl', 'experimental-webgl', 'moz-webgl', 'webkit-3d'];\n        let nameIndex = 0;\n    \n        while (!gl && nameIndex < validContextNames.length) {\n            let contextName = validContextNames[nameIndex];\n    \n            try {\n                if (this.contextOptions) {\n                    gl = canvas.getContext(contextName, this.contextOptions);\n                } else {\n                    gl = canvas.getContext(contextName);\n                }\n            } catch (e) {\n                gl = null;\n            }\n    \n            if (!gl || typeof gl.getParameter !== 'function') {\n                gl = null;\n            }    \n    \n            ++nameIndex;\n        }\n    \n        this.contextGL = gl;\n        // if (this.isWebGL()) {\n        //     document.getElementById('isWebGL').innerHTML = 'true';\n        // } else {\n        //     document.getElementById('isWebGL').innerHTML = 'false';\n        // }\n    }\n\n    initProgram() {\n        let gl = this.contextGL;\n    \n      // vertex shader is the same for all types\n        let vertexShaderScript;\n        let fragmentShaderScript;\n      \n        if (this.type === 'yuv420') {\n    \n            vertexShaderScript = [\n                'attribute vec4 vertexPos;',\n                'attribute vec4 texturePos;',\n                'attribute vec4 uTexturePos;',\n                'attribute vec4 vTexturePos;',\n                'varying vec2 textureCoord;',\n                'varying vec2 uTextureCoord;',\n                'varying vec2 vTextureCoord;',\n    \n                'void main()',\n                '{',\n                '  gl_Position = vertexPos;',\n                '  textureCoord = texturePos.xy;',\n                '  uTextureCoord = uTexturePos.xy;',\n                '  vTextureCoord = vTexturePos.xy;',\n                '}'\n            ].join('\\n');\n        \n            fragmentShaderScript = [\n                'precision highp float;',\n                'varying highp vec2 textureCoord;',\n                'varying highp vec2 uTextureCoord;',\n                'varying highp vec2 vTextureCoord;',\n                'uniform sampler2D ySampler;',\n                'uniform sampler2D uSampler;',\n                'uniform sampler2D vSampler;',\n                'uniform mat4 YUV2RGB;',\n    \n                'void main(void) {',\n                '  highp float y = texture2D(ySampler,  textureCoord).r;',\n                '  highp float u = texture2D(uSampler,  uTextureCoord).r;',\n                '  highp float v = texture2D(vSampler,  vTextureCoord).r;',\n                '  gl_FragColor = vec4(y, u, v, 1) * YUV2RGB;',\n                '}'\n            ].join('\\n');\n        \n        } else if (this.type === 'yuv422') {\n            vertexShaderScript = [\n                'attribute vec4 vertexPos;',\n                'attribute vec4 texturePos;',\n                'varying vec2 textureCoord;',\n    \n                'void main()',\n                '{',\n                '  gl_Position = vertexPos;',\n                '  textureCoord = texturePos.xy;',\n                '}'\n            ].join('\\n');\n        \n            fragmentShaderScript = [\n                'precision highp float;',\n                'varying highp vec2 textureCoord;',\n                'uniform sampler2D sampler;',\n                'uniform highp vec2 resolution;',\n                'uniform mat4 YUV2RGB;',\n    \n                'void main(void) {',\n          \n                '  highp float texPixX = 1.0 / resolution.x;',\n                '  highp float logPixX = 2.0 / resolution.x;', // half the resolution of the texture\n                '  highp float logHalfPixX = 4.0 / resolution.x;', // half of the logical resolution so every 4th pixel\n                '  highp float steps = floor(textureCoord.x / logPixX);',\n                '  highp float uvSteps = floor(textureCoord.x / logHalfPixX);',\n                '  highp float y = texture2D(sampler, vec2((logPixX * steps) + texPixX, textureCoord.y)).r;',\n                '  highp float u = texture2D(sampler, vec2((logHalfPixX * uvSteps), textureCoord.y)).r;',\n                '  highp float v = texture2D(sampler, vec2((logHalfPixX * uvSteps) + texPixX + texPixX, textureCoord.y)).r;',\n          \n          //'  highp float y = texture2D(sampler,  textureCoord).r;',\n          //'  gl_FragColor = vec4(y, u, v, 1) * YUV2RGB;',\n                '  gl_FragColor = vec4(y, u, v, 1.0) * YUV2RGB;',\n                '}'\n            ].join('\\n');\n        }\n    \n        let YUV2RGB = [];\n    \n        if (this.conversionType == 'rec709') {\n          // ITU-T Rec. 709\n            YUV2RGB = [\n                1.16438,  0.00000,  1.79274, -0.97295,\n                1.16438, -0.21325, -0.53291,  0.30148,\n                1.16438,  2.11240,  0.00000, -1.13340,\n                0, 0, 0, 1,\n            ];\n        } else {\n          // assume ITU-T Rec. 601\n            YUV2RGB = [\n                1.16438,  0.00000,  1.59603, -0.87079,\n                1.16438, -0.39176, -0.81297,  0.52959,\n                1.16438,  2.01723,  0.00000, -1.08139,\n                0, 0, 0, 1\n            ];\n        }\n    \n        let vertexShader = gl.createShader(gl.VERTEX_SHADER);\n        gl.shaderSource(vertexShader, vertexShaderScript);\n        gl.compileShader(vertexShader);\n        if (!gl.getShaderParameter(vertexShader, gl.COMPILE_STATUS)) {\n            console.log('Vertex shader failed to compile: ' + gl.getShaderInfoLog(vertexShader));\n        }\n    \n        let fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n        gl.shaderSource(fragmentShader, fragmentShaderScript);\n        gl.compileShader(fragmentShader);\n        if (!gl.getShaderParameter(fragmentShader, gl.COMPILE_STATUS)) {\n            console.log('Fragment shader failed to compile: ' + gl.getShaderInfoLog(fragmentShader));\n        }\n    \n        let program = gl.createProgram();\n        gl.attachShader(program, vertexShader);\n        gl.attachShader(program, fragmentShader);\n        gl.linkProgram(program);\n        if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n            console.log('Program failed to compile: ' + gl.getProgramInfoLog(program));\n        }\n    \n        gl.useProgram(program);\n    \n        let YUV2RGBRef = gl.getUniformLocation(program, 'YUV2RGB');\n        gl.uniformMatrix4fv(YUV2RGBRef, false, YUV2RGB);\n    \n        this.shaderProgram = program;\n    }\n\n    initBuffers() {\n        let gl = this.contextGL;\n        let program = this.shaderProgram;\n      \n        let vertexPosBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, vertexPosBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([1, 1, -1, 1, 1, -1, -1, -1]), gl.STATIC_DRAW);\n      \n        let vertexPosRef = gl.getAttribLocation(program, 'vertexPos');\n        gl.enableVertexAttribArray(vertexPosRef);\n        gl.vertexAttribPointer(vertexPosRef, 2, gl.FLOAT, false, 0, 0);\n        \n        if (this.animationTime) {\n          \n            let animationTime = this.animationTime;\n            let timePassed = 0;\n            let stepTime = 15;\n        \n            let aniFun = function () {\n            \n                timePassed += stepTime;\n                let mul = (1 * timePassed) / animationTime;\n            \n                if (timePassed >= animationTime) {\n                    mul = 1;\n                } else {\n                    setTimeout(aniFun, stepTime);\n                }\n            \n                let neg = -1 * mul;\n                let pos = 1 * mul;\n      \n                let vertexPosBuffer = gl.createBuffer();\n                gl.bindBuffer(gl.ARRAY_BUFFER, vertexPosBuffer);\n                gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([pos, pos, neg, pos, pos, neg, neg, neg]), gl.STATIC_DRAW);\n      \n                let vertexPosRef = gl.getAttribLocation(program, 'vertexPos');\n                gl.enableVertexAttribArray(vertexPosRef);\n                gl.vertexAttribPointer(vertexPosRef, 2, gl.FLOAT, false, 0, 0);\n            \n                try {\n                    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n                } catch (e) {console.log();}\n      \n            };\n            aniFun();\n          \n        }\n      \n        \n      \n        let texturePosBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, texturePosBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([1, 0, 0, 0, 1, 1, 0, 1]), gl.STATIC_DRAW);\n      \n        let texturePosRef = gl.getAttribLocation(program, 'texturePos');\n        gl.enableVertexAttribArray(texturePosRef);\n        gl.vertexAttribPointer(texturePosRef, 2, gl.FLOAT, false, 0, 0);\n      \n        this.texturePosBuffer = texturePosBuffer;\n      \n        if (this.type === 'yuv420') {\n            let uTexturePosBuffer = gl.createBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, uTexturePosBuffer);\n            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([1, 0, 0, 0, 1, 1, 0, 1]), gl.STATIC_DRAW);\n      \n            let uTexturePosRef = gl.getAttribLocation(program, 'uTexturePos');\n            gl.enableVertexAttribArray(uTexturePosRef);\n            gl.vertexAttribPointer(uTexturePosRef, 2, gl.FLOAT, false, 0, 0);\n      \n            this.uTexturePosBuffer = uTexturePosBuffer;\n          \n          \n            let vTexturePosBuffer = gl.createBuffer();\n            gl.bindBuffer(gl.ARRAY_BUFFER, vTexturePosBuffer);\n            gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([1, 0, 0, 0, 1, 1, 0, 1]), gl.STATIC_DRAW);\n      \n            let vTexturePosRef = gl.getAttribLocation(program, 'vTexturePos');\n            gl.enableVertexAttribArray(vTexturePosRef);\n            gl.vertexAttribPointer(vTexturePosRef, 2, gl.FLOAT, false, 0, 0);\n      \n            this.vTexturePosBuffer = vTexturePosBuffer;\n        }\n      \n    }\n      \n    initTextures() {\n        let gl = this.contextGL;\n        let program = this.shaderProgram;\n      \n        if (this.type === 'yuv420') {\n      \n            let yTextureRef = this.initTexture();\n            let ySamplerRef = gl.getUniformLocation(program, 'ySampler');\n            gl.uniform1i(ySamplerRef, 0);\n            this.yTextureRef = yTextureRef;\n      \n            let uTextureRef = this.initTexture();\n            let uSamplerRef = gl.getUniformLocation(program, 'uSampler');\n            gl.uniform1i(uSamplerRef, 1);\n            this.uTextureRef = uTextureRef;\n      \n            let vTextureRef = this.initTexture();\n            let vSamplerRef = gl.getUniformLocation(program, 'vSampler');\n            gl.uniform1i(vSamplerRef, 2);\n            this.vTextureRef = vTextureRef;\n          \n        } else if (this.type === 'yuv422') {\n          // only one texture for 422\n            let textureRef = this.initTexture();\n            let samplerRef = gl.getUniformLocation(program, 'sampler');\n            gl.uniform1i(samplerRef, 0);\n            this.textureRef = textureRef;\n      \n        }\n    }\n\n    initTexture() {\n        let gl = this.contextGL;\n    \n        let textureRef = gl.createTexture();\n        gl.bindTexture(gl.TEXTURE_2D, textureRef);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        gl.bindTexture(gl.TEXTURE_2D, null);\n    \n        return textureRef;\n    }\n    \n    drawNextOutputPicture(width, height, croppingParams, data) {\n        let gl = this.contextGL;\n        if (gl) {\n            this.drawNextOuptutPictureGL(width, height, croppingParams, data);\n        } else {\n            this.drawNextOuptutPictureRGBA(width, height, croppingParams, data);\n        }\n    }\n\n    drawNextOuptutPictureRGBA(width, height, croppingParams, data) {\n        let canvas = this.canvasElement;\n    \n        croppingParams = null;\n    \n        let argbData = data;\n    \n        let ctx = canvas.getContext('2d');\n        let imageData = ctx.getImageData(0, 0, width, height);\n        imageData.data.set(argbData);\n    \n        if (croppingParams === null) {\n            ctx.putImageData(imageData, 0, 0);\n        } else {\n            ctx.putImageData(imageData, -croppingParams.left, -croppingParams.top, 0, 0, croppingParams.width, croppingParams.height);\n        }\n    }\n}\n\nexport default YUVCanvas;","/*\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\n *\n * @author zheng qian <xqq@xqq.im>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlet Browser = {};\n\nfunction detect() {\n    // modified from jquery-browser-plugin\n\n    let ua = self.navigator.userAgent.toLowerCase();\n\n    let match = /(edge)\\/([\\w.]+)/.exec(ua) ||\n        /(opr)[\\/]([\\w.]+)/.exec(ua) ||\n        /(chrome)[ \\/]([\\w.]+)/.exec(ua) ||\n        /(iemobile)[\\/]([\\w.]+)/.exec(ua) ||\n        /(version)(applewebkit)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.exec(ua) ||\n        /(webkit)[ \\/]([\\w.]+).*(version)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.exec(ua) ||\n        /(webkit)[ \\/]([\\w.]+)/.exec(ua) ||\n        /(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec(ua) ||\n        /(msie) ([\\w.]+)/.exec(ua) ||\n        ua.indexOf('trident') >= 0 && /(rv)(?::| )([\\w.]+)/.exec(ua) ||\n        ua.indexOf('compatible') < 0 && /(firefox)[ \\/]([\\w.]+)/.exec(ua) ||\n        [];\n\n    let platform_match = /(ipad)/.exec(ua) ||\n        /(ipod)/.exec(ua) ||\n        /(windows phone)/.exec(ua) ||\n        /(iphone)/.exec(ua) ||\n        /(kindle)/.exec(ua) ||\n        /(android)/.exec(ua) ||\n        /(windows)/.exec(ua) ||\n        /(mac)/.exec(ua) ||\n        /(linux)/.exec(ua) ||\n        /(cros)/.exec(ua) ||\n        [];\n\n    let matched = {\n        browser: match[5] || match[3] || match[1] || '',\n        version: match[2] || match[4] || '0',\n        majorVersion: match[4] || match[2] || '0',\n        platform: platform_match[0] || ''\n    };\n\n    let browser = {};\n    if (matched.browser) {\n        browser[matched.browser] = true;\n\n        let versionArray = matched.majorVersion.split('.');\n        browser.version = {\n            major: parseInt(matched.majorVersion, 10),\n            string: matched.version\n        };\n        if (versionArray.length > 1) {\n            browser.version.minor = parseInt(versionArray[1], 10);\n        }\n        if (versionArray.length > 2) {\n            browser.version.build = parseInt(versionArray[2], 10);\n        }\n    }\n\n    if (matched.platform) {\n        browser[matched.platform] = true;\n    }\n\n    if (browser.chrome || browser.opr || browser.safari) {\n        browser.webkit = true;\n    }\n\n    // MSIE. IE11 has 'rv' identifer\n    if (browser.rv || browser.iemobile) {\n        if (browser.rv) {\n            delete browser.rv;\n        }\n        let msie = 'msie';\n        matched.browser = msie;\n        browser[msie] = true;\n    }\n\n    // Microsoft Edge\n    if (browser.edge) {\n        delete browser.edge;\n        let msedge = 'msedge';\n        matched.browser = msedge;\n        browser[msedge] = true;\n    }\n\n    // Opera 15+\n    if (browser.opr) {\n        let opera = 'opera';\n        matched.browser = opera;\n        browser[opera] = true;\n    }\n\n    // Stock android browsers are marked as Safari\n    if (browser.safari && browser.android) {\n        let android = 'android';\n        matched.browser = android;\n        browser[android] = true;\n    }\n\n    browser.name = matched.browser;\n    browser.platform = matched.platform;\n\n    for (let key in Browser) {\n        if (Browser.hasOwnProperty(key)) {\n            delete Browser[key];\n        }\n    }\n    Object.assign(Browser, browser);\n}\n\ndetect();\n\nexport default Browser;","/*\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\n *\n * @author zheng qian <xqq@xqq.im>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport class RuntimeException {\n\n    constructor(message) {\n        this._message = message;\n    }\n\n    get name() {\n        return 'RuntimeException';\n    }\n\n    get message() {\n        return this._message;\n    }\n\n    toString() {\n        return this.name + ': ' + this.message;\n    }\n\n}\n\nexport class IllegalStateException extends RuntimeException {\n\n    constructor(message) {\n        super(message);\n    }\n\n    get name() {\n        return 'IllegalStateException';\n    }\n\n}\n\nexport class InvalidArgumentException extends RuntimeException {\n\n    constructor(message) {\n        super(message);\n    }\n\n    get name() {\n        return 'InvalidArgumentException';\n    }\n\n}\n\nexport class NotImplementedException extends RuntimeException {\n\n    constructor(message) {\n        super(message);\n    }\n\n    get name() {\n        return 'NotImplementedException';\n    }\n\n}\n","/*\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\n *\n * @author zheng qian <xqq@xqq.im>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventEmitter from 'events';\n\nclass Log {\n\n    static e(tag, msg) {\n        if (!tag || Log.FORCE_GLOBAL_TAG)\n            tag = Log.GLOBAL_TAG;\n\n        let str = `[${tag}] > ${msg}`;\n\n        if (Log.ENABLE_CALLBACK) {\n            Log.emitter.emit('log', 'error', str);\n        }\n\n        if (!Log.ENABLE_ERROR) {\n            return;\n        }\n\n        if (console.error) {\n            console.error(str);\n        } else if (console.warn) {\n            console.warn(str);\n        } else {\n            console.log(str);\n        }\n    }\n\n    static i(tag, msg) {\n        if (!tag || Log.FORCE_GLOBAL_TAG)\n            tag = Log.GLOBAL_TAG;\n\n        let str = `[${tag}] > ${msg}`;\n\n        if (Log.ENABLE_CALLBACK) {\n            Log.emitter.emit('log', 'info', str);\n        }\n\n        if (!Log.ENABLE_INFO) {\n            return;\n        }\n\n        if (console.info) {\n            console.info(str);\n        } else {\n            console.log(str);\n        }\n    }\n\n    static w(tag, msg) {\n        if (!tag || Log.FORCE_GLOBAL_TAG)\n            tag = Log.GLOBAL_TAG;\n\n        let str = `[${tag}] > ${msg}`;\n\n        if (Log.ENABLE_CALLBACK) {\n            Log.emitter.emit('log', 'warn', str);\n        }\n\n        if (!Log.ENABLE_WARN) {\n            return;\n        }\n\n        if (console.warn) {\n            console.warn(str);\n        } else {\n            console.log(str);\n        }\n    }\n\n    static d(tag, msg) {\n        if (!tag || Log.FORCE_GLOBAL_TAG)\n            tag = Log.GLOBAL_TAG;\n\n        let str = `[${tag}] > ${msg}`;\n\n        if (Log.ENABLE_CALLBACK) {\n            Log.emitter.emit('log', 'debug', str);\n        }\n\n        if (!Log.ENABLE_DEBUG) {\n            return;\n        }\n\n        if (console.debug) {\n            console.debug(str);\n        } else {\n            console.log(str);\n        }\n    }\n\n    static v(tag, msg) {\n        if (!tag || Log.FORCE_GLOBAL_TAG)\n            tag = Log.GLOBAL_TAG;\n\n        let str = `[${tag}] > ${msg}`;\n\n        if (Log.ENABLE_CALLBACK) {\n            Log.emitter.emit('log', 'verbose', str);\n        }\n\n        if (!Log.ENABLE_VERBOSE) {\n            return;\n        }\n\n        console.log(str);\n    }\n\n}\n\nLog.GLOBAL_TAG = 'flv.js';\nLog.FORCE_GLOBAL_TAG = false;\nLog.ENABLE_ERROR = true;\nLog.ENABLE_INFO = true;\nLog.ENABLE_WARN = true;\nLog.ENABLE_DEBUG = true;\nLog.ENABLE_VERBOSE = true;\n\nLog.ENABLE_CALLBACK = false;\n\nLog.emitter = new EventEmitter();\n\nexport default Log;","/*\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\n *\n * @author zheng qian <xqq@xqq.im>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nclass Polyfill {\n\n    static install() {\n        // ES6 Object.setPrototypeOf\n        Object.setPrototypeOf = Object.setPrototypeOf || function (obj, proto) {\n            obj.__proto__ = proto;\n            return obj;\n        };\n\n        // ES6 Object.assign\n        Object.assign = Object.assign || function (target) {\n            if (target === undefined || target === null) {\n                throw new TypeError('Cannot convert undefined or null to object');\n            }\n\n            let output = Object(target);\n            for (let i = 1; i < arguments.length; i++) {\n                let source = arguments[i];\n                if (source !== undefined && source !== null) {\n                    for (let key in source) {\n                        if (source.hasOwnProperty(key)) {\n                            output[key] = source[key];\n                        }\n                    }\n                }\n            }\n            return output;\n        };\n\n        // ES6 Promise (missing support in IE11)\n        if (typeof self.Promise !== 'function') {\n            require('es6-promise').polyfill();\n        }\n    }\n\n}\n\nPolyfill.install();\n\nexport default Polyfill;","/*\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\n *\n * This file is derived from C++ project libWinTF8 (https://github.com/m13253/libWinTF8)\n * @author zheng qian <xqq@xqq.im>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nfunction checkContinuation(uint8array, start, checkLength) {\n    let array = uint8array;\n    if (start + checkLength < array.length) {\n        while (checkLength--) {\n            if ((array[++start] & 0xC0) !== 0x80)\n                return false;\n        }\n        return true;\n    } else {\n        return false;\n    }\n}\n\nfunction decodeUTF8(uint8array) {\n    let out = [];\n    let input = uint8array;\n    let i = 0;\n    let length = uint8array.length;\n\n    while (i < length) {\n        if (input[i] < 0x80) {\n            out.push(String.fromCharCode(input[i]));\n            ++i;\n            continue;\n        } else if (input[i] < 0xC0) {\n            // fallthrough\n        } else if (input[i] < 0xE0) {\n            if (checkContinuation(input, i, 1)) {\n                let ucs4 = (input[i] & 0x1F) << 6 | (input[i + 1] & 0x3F);\n                if (ucs4 >= 0x80) {\n                    out.push(String.fromCharCode(ucs4 & 0xFFFF));\n                    i += 2;\n                    continue;\n                }\n            }\n        } else if (input[i] < 0xF0) {\n            if (checkContinuation(input, i, 2)) {\n                let ucs4 = (input[i] & 0xF) << 12 | (input[i + 1] & 0x3F) << 6 | input[i + 2] & 0x3F;\n                if (ucs4 >= 0x800 && (ucs4 & 0xF800) !== 0xD800) {\n                    out.push(String.fromCharCode(ucs4 & 0xFFFF));\n                    i += 3;\n                    continue;\n                }\n            }\n        } else if (input[i] < 0xF8) {\n            if (checkContinuation(input, i, 3)) {\n                let ucs4 = (input[i] & 0x7) << 18 | (input[i + 1] & 0x3F) << 12\n                         | (input[i + 2] & 0x3F) << 6 | (input[i + 3] & 0x3F);\n                if (ucs4 > 0x10000 && ucs4 < 0x110000) {\n                    ucs4 -= 0x10000;\n                    out.push(String.fromCharCode((ucs4 >>> 10) | 0xD800));\n                    out.push(String.fromCharCode((ucs4 & 0x3FF) | 0xDC00));\n                    i += 4;\n                    continue;\n                }\n            }\n        }\n        out.push(String.fromCharCode(0xFFFD));\n        ++i;\n    }\n\n    return out.join('');\n}\n\nexport default decodeUTF8;"]}